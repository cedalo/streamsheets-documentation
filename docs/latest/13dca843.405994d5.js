(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{378:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return d}));var a=n(0),s=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var c=s.a.createContext({}),m=function(e){var t=s.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},h=function(e){var t=m(e.components);return s.a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return s.a.createElement(s.a.Fragment,{},t)}},b=s.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),h=m(n),b=a,d=h["".concat(o,".").concat(b)]||h[b]||u[b]||r;return n?s.a.createElement(d,i(i({ref:t},c),{},{components:n})):s.a.createElement(d,i({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=b;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var c=2;c<r;c++)o[c]=n[c];return s.a.createElement.apply(null,o)}return s.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},423:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Streamsheet1-1b75feb3f48c555e76e34f3334f39f94.PNG"},424:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Inbox-10f9f4888442cf1d7a4000f71c32173c.JPG"},425:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/GRID-c1b1d990ebcd74d113caae8fbc366503.PNG"},83:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return i})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return m}));var a=n(3),s=n(7),r=(n(0),n(378)),o={id:"components-streamsheet",title:"Streamsheet",sidebar_label:"Streamsheet"},i={unversionedId:"streamsheets/maincomponents/components-streamsheet",id:"streamsheets/maincomponents/components-streamsheet",isDocsHomePage:!1,title:"Streamsheet",description:"Streamsheets are the main components to create the logic for your use",source:"@site/docs/streamsheets/maincomponents/streamsheet.md",slug:"/streamsheets/maincomponents/components-streamsheet",permalink:"/latest/docs/streamsheets/maincomponents/components-streamsheet",version:"current",sidebar_label:"Streamsheet",sidebar:"someSidebar",previous:{title:"Streams",permalink:"/latest/docs/streamsheets/maincomponents/components-streams"},next:{title:"Getting Started",permalink:"/latest/docs/streamsheets/getting-started"}},l=[{value:'Inbox<span id="Inbox picture"></span>',id:"inbox",children:[]},{value:"Inbox Settings",id:"inbox-settings",children:[]},{value:"Grid",id:"grid",children:[]},{value:"Streamsheets Settings",id:"streamsheets-settings",children:[]},{value:"Messages",id:"messages",children:[]}],c={rightToc:l};function m(e){var t=e.components,o=Object(s.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},c,o,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Streamsheets are the main components to create the logic for your use\ncases. Here you model how an App works and, thus, how data streams are\nprocessed, analysed, visualized, combined and controlled or even\nsimulated."),Object(r.b)("p",null,Object(r.b)("img",{alt:"Streamsheet1",src:n(423).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"To connect a data stream to a Streamsheet you can:")),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Select a onsumer (This is the most common case; however, a\nConsumer must be created in the administration first)"),Object(r.b)("li",{parentName:"ul"},"Use specific functions, e.g. ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"../functions/streams/opcuaread"}),"OPCUA.READ")," or\n",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"../functions/streams/httprequest"}),"HTTP.REQUEST")," with GET-Method")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"To create an outgoing data stream or make data available you have\nseveral options:")),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Choose a Producer function, e.g. ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"../functions/streams/mqttpublish"}),"MQTT.PUBLISH")," or ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"../functions/streams/kafkapublish"}),"KAFKA.PUBLISH")),Object(r.b)("li",{parentName:"ul"},"Choose a posting function, e.g. ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"../functions/streams/opcuawrite"}),"OPCUA.WRITE")," or ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"../functions/streams/httprequest"}),"HTTP.REQUEST")," with POST-Method"),Object(r.b)("li",{parentName:"ul"},"Expose the App as OPC UA or REST Server so that other services can access its data"),Object(r.b)("li",{parentName:"ul"},"Store the data in a database, e.g. by using ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"../functions/streams/timescaleselect"}),"TIMESCALE.INSERT"))),Object(r.b)("p",null,"Often, a Streamsheet consumes and produces streams. Nonetheless, neither\nan incoming nor an outgoing data stream are mandatory. For instance,\nStreamsheets which are calculated repeatedly and only produce streams\nare great for simulating sensors, machines, APIs and other data sources.\nOn the other hand, sheets with pure dashboard and visualization\nfunctionality typically only consume streams without generating one on\ntheir own."),Object(r.b)("p",null,"Each Streamsheet consists of an Inbox and a Grid."),Object(r.b)("h2",{id:"inbox"},"Inbox",Object(r.b)("span",{id:"Inbox picture"})),Object(r.b)("p",null,"As in a mail service, the Inbox marks the point where new messages\narrive and queue in order of their arrival time before they are\nprocessed. Although the Inbox only displays up to a maximum of 100\nmessages on your client (your browser), an unlimited amount can be\nqueued on the server. The structure and content of a message is given in\nfull detail and presented as a JSON Object in the Payload section.\nShould the original data format not be JSON, the format is automatically\nconverted. Via drag and drop some or all payload elements of incoming\nmessages can be linked to the grid. Now, every time a new message\narrives and the Streamsheet is calculated, the respective cells are\nupdated. Message streams are connected to a Streamsheet by selecting a\nConsumer in the Inbox Settings. The name of the selected Consumer is\nthen also shown above the Inbox. Consumers define incoming data streams\n(More on them under Consumers)."),Object(r.b)("p",null,Object(r.b)("img",{alt:"Inbox",src:n(424).default})),Object(r.b)("p",null,"The inbox above holds two messages. The first has the Message-IDs\nHJFG5rEDV and holds one data element as content, a temperature\nmeasurement."),Object(r.b)("h2",{id:"inbox-settings"},"Inbox Settings"),Object(r.b)("p",null,"In this settings menu you decide which data streams a Streamsheet\nconsumes and also its recalculation mode. The settings explained point\nby point:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"\u201cConsumer\u201d lists all available Consumers. Choose the one which\ndelivers the desired data streams. To define new or adjust existing\nConsumers, please go to the Administration Menu.")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"\u201cCalculate Streamsheet\u201d defines the recalculation mode of a\nStreamsheet:"),Object(r.b)("blockquote",{parentName:"li"},Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},"\u201c",Object(r.b)("strong",{parentName:"li"},"Continuously"),"\u201d: The Streamsheet is recalculated\ncontinuously and cyclically until the App is stopped - also if\nNO messages are received. The sheet\xb4s cycle time is the cycle\ntime of the App. (This is the default setting)"),Object(r.b)("li",{parentName:"ul"},"\u201c",Object(r.b)("strong",{parentName:"li"},"On Message Arrival"),"\u201d: Every time a message is received,\nthe sheet is calculated immediately. In this mode message\nqueues are not formed because the sheet is recalculated\nirrespective of the cycle time of the App."),Object(r.b)("li",{parentName:"ul"},"\u201c",Object(r.b)("strong",{parentName:"li"},"On EXECUTE Formula"),"\u201d: The calculation of a Streamsheet is\ntriggered by another Streamsheet which contains an ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"../functions/streamsheet/execute"}),"EXECUTE"),"\nformula. This triggering sheet must be in the same App. Note:\nThe sheet triggering the execution will pause its calculation\nin the cell containing EXECUTE, wait until the triggered sheet\nhas completed its calculation and, then, resume its\ncalculation."),Object(r.b)("li",{parentName:"ul"},"\u201c",Object(r.b)("strong",{parentName:"li"},"On App Start"),"\u201d: The Streamsheet calculates once when the\nApp is started."),Object(r.b)("li",{parentName:"ul"},"\u201c",Object(r.b)("strong",{parentName:"li"},"On App Stop"),"\u201d: The Streamsheet calculates when the App is\nbeing stopped."),Object(r.b)("li",{parentName:"ul"},"\u201c",Object(r.b)("strong",{parentName:"li"},"On Time"),"\u201d: A date and time for the calculation can be\ndefined. Additionally, a sheet-specific interval can be set to\nrecalculate the sheet cyclically. This interval only applies\nto this sheet and overwrites the cycle time of its App."),Object(r.b)("li",{parentName:"ul"},"\u201c",Object(r.b)("strong",{parentName:"li"},"On Random"),"\u201d: A date and time for the calculation and\nadditionally an interval for the recalculation can be defined.\nIn this respect it is similar to \u201cOn Time\u201d, however, the\ncalculation will not be triggered at the beginning of each\ninterval but randomly during the interval. This mode provides\na way for introducing randomness, which can be interesting\nwhen simulating data sources, for instance.")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Loop through array (one calculation per array element): This comes\nin handy if your messages contain information through which you want\nto loop, e.g. a list of ordered products. If this option is checked,\nan array element within incoming messages can be selected. Then, the\nStreamsheet loops through all elements which are subsumed under this\narray element. As a result, not one message per calculation is\nprocessed but only one element under the array element. The easiest\nway to set a loop element is to right-click on it in the\ninbox-payload and choose this option. Alternatively, you can define\nit and its superelement by listing the respective keys.")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"\u201eHide unprocessed Messages\u201d: If this option is checked, a\nqueue of messages is not displayed in the inbox. Only the next\nmessage to be processed is displayed."))),Object(r.b)("div",{className:"admonition admonition-info alert alert--info"},Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(r.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"A Consumer delivers messages to a Streamsheet.\nVia drag & drop the content of messages can be linked to the Streamsheet\ngrid. A Producer can be used to send messages from a Streamsheet to a\ndestination. Check out ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"../getting-started"}),'"Getting Started"')," to learn more."))),Object(r.b)("h2",{id:"grid"},"Grid"),Object(r.b)("p",null,"The grid of a Streamsheet is the place where the logic for analysing,\nprocessing and visualizing data is modelled. This is done by using\nspreadsheet functions and the tools you find in the tool bar.\nStreamsheets offer familiar spreadsheet formulas, as e.g. known from MS\nExcel or Google Sheets, as well as formulas especially designed for\nworking with data streams and dynamic data structures. All formulas are\nexplained in detail in the functions section. The recalculation of a\nStreamsheet can be triggered in various ways, e.g. always when a new\nmessage arrives, at specific points in time or cyclically. (Jump to\nInbox Settings to see all calculation modes) However when a\nStreamsheet is calculated, this always happens cell by cell from left to\nright and from top to bottom thus maximizing transparency over what is\nhappening in which order. Special columns"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"IF-Column:")," This is the first column right before \u201cA\u201d. Cells in\nthis column take conditions and based on the state of these\nconditions, the respective rows are being calculated or not. As a\nresult, IF-cells switch the calculation of entire rows and their\ncells on and off. The default value of IF-cells is TRUE. Thus, if\nIF-cells are empty, the rows are calculated."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"COMMENT-Column:")," Even further to the left of the IF-column is the\nCOMMENT column which is hidden by default. This column is intended\nfor documenting what your model does.")),Object(r.b)("p",null,Object(r.b)("img",{alt:"GRID",src:n(425).default})),Object(r.b)("p",null,"In the left corner above the grid, the name of the Streamsheet is given\nand how many times it has been calculated since the last App stop (Note:\nPausing an App will not reset the Step Counter). On the right, you can\nmaximize, minimize and delete a sheet or open its settings."),Object(r.b)("h2",{id:"streamsheets-settings"},"Streamsheets Settings"),Object(r.b)("p",null,"In this menu you find the settings for the basic structure and\nappearance of a Streamsheet."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Settings:")),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"Name"),": A Streamsheet can be renamed."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"Columns"),": Set the number of columns (Max: 50)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"Rows"),": Set the number of rows (Max: 200)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"Protect sheet"),": No interaction with grid or the Inbox is possible"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"Show Grid"),": Display the grid or do not"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"Show Headers"),": Display column and row titles or do not"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"Show Formulas"),": Decide whether you want to see the formulas or\nthe current values of cells in the sheet."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"Show Inbox"),": Display the Inbox or do not"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"Paint IF Rows with transparency"),": If this box is checked, the\ncontent of rows which contain a statement in the IF-column are\ntransparent. This improves transparency and helps you to immediately\nidentify the rows which are being switch on and off when the App is\nrunning.")),Object(r.b)("div",{className:"admonition admonition-info alert alert--info"},Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(r.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("ul",{parentName:"div"},Object(r.b)("li",{parentName:"ul"},"Streamsheets are always calculated from left to right and from\ntop to bottom."),Object(r.b)("li",{parentName:"ul"},"Depending on a condition in the IF column, the calculation of\nwhole rows can be switched on and off.")))),Object(r.b)("h2",{id:"messages"},"Messages"),Object(r.b)("p",null,"In the Streamsheet environment, all messages are JSON objects. In case\nthe original data format is not JSON, but e.g. csv, xml or a text file,\nthe format is automatically converted to JSON."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"JSON")),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Json objects are a hierarchy of key-value pairs. This means that any\nvalue, e.g. a number or a string, is identified by its key. You\ncould think of the key as the name or the title of its value. In\norder not to just have a flat list of key-value pairs, these can be\nordered and subsumed, e.g. in the Inbox picture the key-value pair\n\u201cTemperature: 34\u201d is subsumed under the top-element \u201cData\u201d.")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Connect message content to the Grid")),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"To link data elements of an incoming stream to the grid, simply\ndrag-and-drop the respective elements. You can also link all\nelements under a top-element at once by drag-and-dropping their\ntop-element. If you hit Strg or Cmd while you are doing this, the\ndrag-and-drop range turns by 90\xb0."),Object(r.b)("li",{parentName:"ul"},"Of course, Streamsheets offer the possibility to use a function to\nread incoming data. This function is called READ and it is also\nautomatically created when you drag-and-drop elements into the\nsheet.")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Generate message content aka a JSON object in the sheet")),Object(r.b)("p",null,"In order to send data, you need to create a JSON object and then use a\nproducer or posting function."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"You can convert any coherent cell range consisting of two columns\nand an arbitrary number of rows into a JSON object. Simply select\nthe range, then, right-click it and choose \u201cDefine JSON Range\u201d. This\ngenerates a flat JSON object, that is to say that all keys are in\nthe first column, the respective values are in the second column and\nthe object is not hierarchically structured. To build a hierarchy,\nselect the elements you want to subsume and hit \u201ctab\u201d on your\nkeyboard. If you want to undo this operation, just hit \u201ctab\u201d and\n\u201cshift\u201d at the same time."),Object(r.b)("li",{parentName:"ul"},"If you turn more than 2 columns into a single JSON range, the first\ncolumn will contain the keys whereas the remaining columns\naccommodate the values. Example: A range of 4 columns is turned into\na JSON range. The first column contains the keys which all\nvalue-columns will share. Each value-column will automatically\nassume the keys in the first column to build key-value pairs."),Object(r.b)("li",{parentName:"ul"},"To send messages or make JSON ranges available choose one of the\nways mentioned under Streamsheets")))}m.isMDXComponent=!0}}]);