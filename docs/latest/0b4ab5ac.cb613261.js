(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{409:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(0),a=n.n(r);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=a.a.createContext({}),u=function(e){var t=a.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):b(b({},t),e)),n},s=function(e){var t=u(e.components);return a.a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},O=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,c=e.originalType,o=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),s=u(n),O=r,d=s["".concat(o,".").concat(O)]||s[O]||p[O]||c;return n?a.a.createElement(d,b(b({ref:t},l),{},{components:n})):a.a.createElement(d,b({ref:t},l))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var c=n.length,o=new Array(c);o[0]=O;var b={};for(var i in t)hasOwnProperty.call(t,i)&&(b[i]=t[i]);b.originalType=e,b.mdxType="string"==typeof e?e:r,o[1]=b;for(var l=2;l<c;l++)o[l]=n[l];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,n)}O.displayName="MDXCreateElement"},410:function(e,t,n){"use strict";n.r(t),t.default="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTExLjk5IDJDNi40NyAyIDIgNi40OCAyIDEyczQuNDcgMTAgOS45OSAxMEMxNy41MiAyMiAyMiAxNy41MiAyMiAxMlMxNy41MiAyIDExLjk5IDJ6bTQuMjQgMTZMMTIgMTUuNDUgNy43NyAxOGwxLjEyLTQuODEtMy43My0zLjIzIDQuOTItLjQyTDEyIDVsMS45MiA0LjUzIDQuOTIuNDItMy43MyAzLjIzTDE2LjIzIDE4eiIvPjwvc3ZnPg=="},74:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return b})),n.d(t,"rightToc",(function(){return i})),n.d(t,"default",(function(){return u}));var r=n(3),a=n(7),c=(n(0),n(409)),o={},b={unversionedId:"streamsheets/functions/streams/opcuawrite",id:"streamsheets/functions/streams/opcuawrite",isDocsHomePage:!1,title:"opcuawrite",description:"OPCUA.WRITE",source:"@site/docs/streamsheets/functions/streams/opcuawrite.md",slug:"/streamsheets/functions/streams/opcuawrite",permalink:"/latest/docs/streamsheets/functions/streams/opcuawrite",version:"current"},i=[],l={rightToc:i};function u(e){var t=e.components,o=Object(a.a)(e,["components"]);return Object(c.b)("wrapper",Object(r.a)({},l,o,{components:t,mdxType:"MDXLayout"}),Object(c.b)("h1",{id:"opcuawrite"},"OPCUA.WRITE"),Object(c.b)("p",null,Object(c.b)("img",{alt:"star",src:n(410).default})," This is a ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://cedalo.com/download/"}),"Streamsheets\nPremium")," feature."),Object(c.b)("p",null,"Sends a write request of a value to an ",Object(c.b)("inlineCode",{parentName:"p"},"OPC UA")," Server. The Server will\nrespond, if the write was successful or not. You can use the\n",Object(c.b)("inlineCode",{parentName:"p"},"Function Wizard <functionwizard>")," for this function. Click\n",Object(c.b)("inlineCode",{parentName:"p"},"here<opcuafunctions>")," for a more detailed tutorial on opcua functions."),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"Syntax")),Object(c.b)("p",null,"=OPCUA.WRITE(",Object(c.b)("inlineCode",{parentName:"p"},"Producer"),", Node, ValueJSON, Target","[",",ResultKeys,\nTimeout","]",")"),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"Arguments")),Object(c.b)("table",null,Object(c.b)("thead",{parentName:"table"},Object(c.b)("tr",{parentName:"thead"},Object(c.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Name"),Object(c.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Description"))),Object(c.b)("tbody",{parentName:"table"},Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Producer"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Producer to use for publishing.")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Node"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Path of the node to write to or node id.")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"ValueJSON"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(c.b)("inlineCode",{parentName:"td"},"JSON"),' with a "value" and a "dataType" field containing the value to write and the data type of the value.')),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Target"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Target of the result of the write operation. Can be either ",Object(c.b)("inlineCode",{parentName:"td"},"INBOX <inboxf>"),"(), ",Object(c.b)("inlineCode",{parentName:"td"},"OUTBOX"),'("MsgID") or a cell range.')),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"ResultKeys"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Optional. Limit the result to the specified JSON Keys")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Timeout"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Optional. The time to wait for an answer. When left empty a 20 second timeout is being used.")))),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"Return Value")),Object(c.b)("p",null,"The function OPCUA.WRITE always returns a unique random request ID,\nwhich can be used with ",Object(c.b)("inlineCode",{parentName:"p"},"requestinfo")," to check the state of the request."),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"Examples")),Object(c.b)("table",null,Object(c.b)("colgroup",null,Object(c.b)("col",{style:"width: 52%"}),Object(c.b)("col",{style:"width: 13%"}),Object(c.b)("col",{style:"width: 34%"})),Object(c.b)("thead",null,Object(c.b)("tr",{class:"header"},Object(c.b)("th",null,"Function"),Object(c.b)("th",null,"Result"),Object(c.b)("th",null,"Comment"))),Object(c.b)("tbody",null,Object(c.b)("tr",{class:"odd"},Object(c.b)("td",null,Object(c.b)("div",{class:"line-block"},'=OPCUA.WRITE("OPCUA Producer","/Objects/1:Machines/',Object(c.b)("br",null),'1:H1mrblX0X/name",JSON(',Object(c.b)("span",{class:"blue"},"A2:B3"),"), ",Object(c.b)("code",{class:"interpreted-text",role:"ref"},"INBOX <inboxf>"),"())",Object(c.b)("br",null))),Object(c.b)("td",null,"The request ID"),Object(c.b)("td",null,'This sets the name of the machine with the id "H1mrblX0X" to "New Name". The result of the operation, either confirmation or any error is placed into the ',Object(c.b)("code",{class:"interpreted-text",role:"ref"},"INBOX"),".")))))}u.isMDXComponent=!0}}]);