"use strict";(self.webpackChunkstreamsheets=self.webpackChunkstreamsheets||[]).push([[56674],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var i=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),p=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return i.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,f=m["".concat(s,".").concat(d)]||m[d]||c[d]||r;return n?i.createElement(f,o(o({ref:t},u),{},{components:n})):i.createElement(f,o({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var p=2;p<r;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},49111:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>y,contentTitle:()=>d,default:()=>S,frontMatter:()=>m,metadata:()=>f,toc:()=>h});var i=n(3905),a=Object.defineProperty,r=Object.defineProperties,o=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,c=(e,t)=>{for(var n in t||(t={}))s.call(t,n)&&u(e,n,t[n]);if(l)for(var n of l(t))p.call(t,n)&&u(e,n,t[n]);return e};const m={id:"platform-saml-auth",title:"SAML Authentication",sidebar_label:"SAML Authentication"},d=void 0,f={unversionedId:"security/platform-access/platform-saml-auth",id:"version-3.0/security/platform-access/platform-saml-auth",title:"SAML Authentication",description:"This feature is only available in the enterprise version.",source:"@site/mosquitto_versioned_docs/version-3.0/security/platform-access/platform-saml-auth.md",sourceDirName:"security/platform-access",slug:"/security/platform-access/platform-saml-auth",permalink:"/mosquitto/security/platform-access/platform-saml-auth",draft:!1,tags:[],version:"3.0",frontMatter:{id:"platform-saml-auth",title:"SAML Authentication",sidebar_label:"SAML Authentication"},sidebar:"someSidebar",previous:{title:"LDAP Authentication",permalink:"/mosquitto/security/platform-access/platform-ldap-auth"},next:{title:"Server Certificates",permalink:"/mosquitto/security/certificates/server-certificates"}},y={},h=[{value:"SAML-based SSO",id:"saml-based-sso",level:2},{value:"Terminology",id:"terminology",level:3},{value:"SP Endpoints",id:"sp-endpoints",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Limitations",id:"limitations",level:3}],k={toc:h};function S(e){var t,n=e,{components:a}=n,u=((e,t)=>{var n={};for(var i in e)s.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&l)for(var i of l(e))t.indexOf(i)<0&&p.call(e,i)&&(n[i]=e[i]);return n})(n,["components"]);return(0,i.kt)("wrapper",(t=c(c({},k),u),r(t,o({components:a,mdxType:"MDXLayout"}))),(0,i.kt)("admonition",c({},{type:"note"}),(0,i.kt)("p",{parentName:"admonition"},"This feature is only available in the enterprise version.")),(0,i.kt)("h2",c({},{id:"saml-based-sso"}),"SAML-based SSO"),(0,i.kt)("p",null,"SAML-based SSO feature enables support for any SSO provider that supports OAuth authentication flow based on SAML 2.0\nprotocol."),(0,i.kt)("p",null,"This feature can be configured by specifying several environment variables for the Mosquitto MQTT Platform."),(0,i.kt)("h3",c({},{id:"terminology"}),"Terminology"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Single Sign On (SSO) - The process of using a single account to login across many applications")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Single Log Out (SLO, sometimes also called Single Sign Out) - The process of terminating all active sessions\nassociated with the same user across all connected applications when the user logs out from one application.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"SAML - XML-based communication protocol used for the SSO and SLO processes when exchanging messages between SP and\nIdP.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Service Provider (SP) - Application that you use SSO to login into.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Identity Provider (IdP) - A centralized entity facilitating SSO process that users authenticate into. After successful\nauthentication it securely communicates user identity data with SPs allowing users to access them."))),(0,i.kt)("h3",c({},{id:"sp-endpoints"}),"SP Endpoints"),(0,i.kt)("p",null,"You might need to configure the Assertion Consumer Service (ACS) URL in your identity provider. The URL for Mosquitto\nPlatform is ",(0,i.kt)("inlineCode",{parentName:"p"},"<platform_host_url>/api/oauth/saml")," and it expects a POST request containing a SAML response object\nobtained after a successful authentication to the identity provider."),(0,i.kt)("p",null,"In case you need to redirect your identity provider to the application's error page, you may\nuse ",(0,i.kt)("inlineCode",{parentName:"p"},"<platform_host_url>/auth/error"),". If you need to specify a particular error\nthen: ",(0,i.kt)("inlineCode",{parentName:"p"},"<platform_host_url>/auth/error?error=someError"),". This is however a non-standard convenience redirect, so unlike\nACS URL you won't need to worry about it for most Identity Providers."),(0,i.kt)("h3",c({},{id:"configuration"}),"Configuration"),(0,i.kt)("p",null,"In order to enable the feature you have to:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Make sure you don't have any existing Platform users that use the same email as SSO flow.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Add ",(0,i.kt)("inlineCode",{parentName:"p"},"saml")," to the comma separated list of authentication providers specified in ",(0,i.kt)("inlineCode",{parentName:"p"},"AUTH_PROVIDERS")," environment\nvariable.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Specify ",(0,i.kt)("inlineCode",{parentName:"p"},"AUTH_CUSTOM_SP_ENTITY_ID")," which represents Mosquitto Platform's entity ID configured in your identity\nprovider such as AzureID, Okta, OneLogin etc.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Specify SSO email addresses that you want to register in Mosquitto Platform as a comma separated list in\nthe ",(0,i.kt)("inlineCode",{parentName:"p"},"AUTH_CUSTOM_ALLOWED_SIGNUP_EMAILS")," environment variable.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Specify your SAML metadata url via ",(0,i.kt)("inlineCode",{parentName:"p"},"AUTH_CUSTOM_SAML_METADATA_URL"),". If instead you have a metadata file,\nuse ",(0,i.kt)("inlineCode",{parentName:"p"},"AUTH_CUSTOM_RAW_SAML_METADATA_FILE_PATH")," to specify its full path. For raw or base64 metadata,\nspecify ",(0,i.kt)("inlineCode",{parentName:"p"},"AUTH_CUSTOM_RAW_SAML_METADATA"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"If you want to configure single logout (SLO), specify ",(0,i.kt)("inlineCode",{parentName:"p"},"AUTH_CUSTOM_SLO_URL")," environment variable which should point to\nyour identity provider's SLO endpoint."))),(0,i.kt)("p",null,"You can optionally specify the following variables:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_NAME")," to display a different provider name on the SSO button on login and signup pages. Default name\nis ",(0,i.kt)("inlineCode",{parentName:"li"},"SSO"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_PROFILE_IMAGE_CLAIM")," to specify a claim of the user object returned by your identity provider where user\nprofile image is stored."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_PROFILE_IMAGE_URL")," to set a default image for your users.\nExample: ",(0,i.kt)("inlineCode",{parentName:"li"},"https://my-org.org/media/profile)image.png")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_LOGO_URL")," to set a default logo for the SSO button. Example: ",(0,i.kt)("inlineCode",{parentName:"li"},"https://my-org.org/media/logo.png")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_PROFILE_FIRSTNAME_CLAIM")," to specify a non-standard claim of the user object returned by your identity\nprovider that stores first name. If a standard claim is used,\ni.e. ",(0,i.kt)("inlineCode",{parentName:"li"},"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"),", there is no need to specify this variable."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_PROFILE_LASTNAME_CLAIM")," to specify a non-standard claim of the user object returned by your identity\nprovider that stores last name. If a standard claim is used,\ni.e. ",(0,i.kt)("inlineCode",{parentName:"li"},"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"),", there is no need to specify this variable."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_PROFILE_NAME_CLAIM")," to specify a non-standard claim of the user object returned by your identity provider\nthat stores both first name and last name separated by a space. This variable doesn't need to be specified if there\nare separate claims for the first name and last name in your user object.")),(0,i.kt)("p",null,"In case your identity provider does not expose metadata, you can specify the following instead:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_IDP_ENTITY_ID")," to specify entity id of the identity provider."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_IDP_CERTIFICATE")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_IDP_CERTIFICATE_FILE_PATH")," to specify identity provider's certificate as\na plain string or file path respectively."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_IDP_URL")," to specify identity provider's sign-in URL."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_IDP_BINDINGS")," to optionally specify a comma separated list of HTTP bindings (Redirect or POST) which can\ntypically be safely omitted. Example: ",(0,i.kt)("inlineCode",{parentName:"li"},"httpRedirect,httpPost"),". These bindings specify which request type (",(0,i.kt)("inlineCode",{parentName:"li"},"GET"),"\nor ",(0,i.kt)("inlineCode",{parentName:"li"},"POST"),") should be used to redirect to your IdP.")),(0,i.kt)("p",null,"To debug SSO flow:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Set ",(0,i.kt)("inlineCode",{parentName:"li"},"AUTH_CUSTOM_DEBUG")," environment variable to ",(0,i.kt)("inlineCode",{parentName:"li"},"1"))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Note")),(0,i.kt)("p",{parentName:"blockquote"},'Sometimes entity id fields can be called "issuer" or "audience" when looking for them in your identity provider.\nIssuer is typically used for IdP entity ID, while audience often represents SP\'s entity ID.')),(0,i.kt)("h3",c({},{id:"limitations"}),"Limitations"),(0,i.kt)("p",null,"Currently, Mosquitto MQTT Platform doesn't support IdP initiated SLO. This means that if a user initiates an SLO process\nfrom a different application, identity provider will not be able to relay this request to the Mosquitto MQTT Platform to\nterminate its user session. Platform is currently only able to initiate SLO requests but not receive them when they\noriginate from other apps."))}S.isMDXComponent=!0}}]);