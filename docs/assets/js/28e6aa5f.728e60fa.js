"use strict";(self.webpackChunkstreamsheets=self.webpackChunkstreamsheets||[]).push([[85600],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return h}});var i=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),p=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=p(e.components);return i.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,d=r(e,["components","mdxType","originalType","parentName"]),u=p(n),h=a,c=u["".concat(s,".").concat(h)]||u[h]||m[h]||o;return n?i.createElement(c,l(l({ref:t},d),{},{components:n})):i.createElement(c,l({ref:t},d))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=u;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:a,l[1]=r;for(var p=2;p<o;p++)l[p]=n[p];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},75926:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return r},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return d},default:function(){return u}});var i=n(87462),a=n(63366),o=(n(67294),n(3905)),l=["components"],r={id:"manpage-mosquitto-conf",title:"mosquitto.conf man page",sidebar_label:"mosquitto.conf"},s=void 0,p={unversionedId:"manpage-mosquitto-conf",id:"version-2.1/manpage-mosquitto-conf",title:"mosquitto.conf man page",description:"Name",source:"@site/mosquitto_versioned_docs/version-2.1/manpage-mosquitto-conf.md",sourceDirName:".",slug:"/manpage-mosquitto-conf",permalink:"/mosquitto/2.1/manpage-mosquitto-conf",tags:[],version:"2.1",frontMatter:{id:"manpage-mosquitto-conf",title:"mosquitto.conf man page",sidebar_label:"mosquitto.conf"},sidebar:"someSidebar",previous:{title:"Mosquitto",permalink:"/mosquitto/2.1/manpage-mosquitto"},next:{title:"mosquitto_passwd",permalink:"/mosquitto/2.1/manpage-mosquitto-passwd"}},d=[{value:"Name",id:"name",children:[],level:3},{value:"Synopsis",id:"synopsis",children:[],level:3},{value:"Description",id:"description",children:[],level:3},{value:"File Format",id:"file-format",children:[],level:3},{value:"Authentication",id:"authentication",children:[],level:3},{value:"General Options",id:"general-options",children:[{value:"Important",id:"important",children:[],level:4}],level:3},{value:"Listeners",id:"listeners",children:[{value:"General Options",id:"general-options-1",children:[],level:4},{value:"Certificate based SSL/TLS Support",id:"certificate-based-ssltls-support",children:[],level:4},{value:"Pre-shared-key based SSL/TLS Support",id:"pre-shared-key-based-ssltls-support",children:[],level:4}],level:3},{value:"Configuring Bridges",id:"configuring-bridges",children:[{value:"SSL/TLS Support",id:"ssltls-support",children:[],level:4}],level:3},{value:"Files",id:"files",children:[],level:3}],m={toc:d};function u(e){var t=e.components,n=(0,a.Z)(e,l);return(0,o.kt)("wrapper",(0,i.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"name"},"Name"),(0,o.kt)("p",null,"mosquitto.conf \u2014 the configuration file for mosquitto"),(0,o.kt)("h3",{id:"synopsis"},"Synopsis"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"mosquitto.conf")),(0,o.kt)("h3",{id:"description"},"Description"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"mosquitto.conf")," is the configuration file for mosquitto. This file can reside anywhere as long as mosquitto can read it. By default, mosquitto does not need a configuration file and will use the default values listed below. See ",(0,o.kt)("a",{parentName:"p",href:"./manpage-mosquitto"},"mosquitto(8)")," for information on how to load a configuration file."),(0,o.kt)("h3",{id:"file-format"},"File Format"),(0,o.kt)("p",null,"All lines with a # as the very first character are treated as a comment."),(0,o.kt)("p",null,"Configuration lines start with a variable name. The variable value is separated from the name by a single space."),(0,o.kt)("h3",{id:"authentication"},"Authentication"),(0,o.kt)("p",null,"The authentication options described below allow a wide range of possibilities in conjunction with the listener options. This section aims to clarify the possibilities."),(0,o.kt)("p",null,"The simplest option is to have no authentication at all. This is the default if no other options are given. Unauthenticated encrypted support is provided by using the certificate based SSL/TLS based options certfile and keyfile."),(0,o.kt)("p",null,"MQTT provides username/password authentication as part of the protocol. Use the password","_","file option to define the valid usernames and passwords. Be sure to use network encryption if you are using this option otherwise the username and password will be vulnerable to interception. Use the ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," to control whether passwords are required globally or on a per-listener basis."),(0,o.kt)("p",null,"When using certificate based encryption there are three options that affect authentication. The first is require","_","certificate, which may be set to true or false. If false, the SSL/TLS component of the client will verify the server but there is no requirement for the client to provide anything for the server: authentication is limited to the MQTT built in username/password. If require","_","certificate is true, the client must provide a valid certificate in order to connect successfully. In this case, the second and third options, use","_","identity","_","as","_","username and use","_","subject","_","as","_","username, become relevant. If set to true, use","_","identity","_","as","_","username causes the Common Name (CN) from the client certificate to be used instead of the MQTT username for access control purposes. The password is not used because it is assumed that only authenticated clients have valid certificates. This means that any CA certificates you include in cafile or capath will be able to issue client certificates that are valid for connecting to your broker. If use","_","identity","_","as","_","username is false, the client must authenticate as normal (if required by password","_","file) through the MQTT options. The same principle applies for the use","_","subject","_","as","_","username option, but the entire certificate subject is used as the username instead of just the CN."),(0,o.kt)("p",null,"When using pre-shared-key based encryption through the psk","_","hint and psk","_","file options, the client must provide a valid identity and key in order to connect to the broker before any MQTT communication takes place. If use","_","identity","_","as","_","username is true, the PSK identity is used instead of the MQTT username for access control purposes. If use","_","identity","_","as","_","username is false, the client may still authenticate using the MQTT username/password if using the password","_","file option."),(0,o.kt)("p",null,"Both certificate and PSK based encryption are configured on a per-listener basis."),(0,o.kt)("p",null,"Authentication plugins can be created to augment the password","_","file, acl","_","file and psk","_","file options with e.g. SQL based lookups."),(0,o.kt)("p",null,"It is possible to support multiple authentication schemes at once. A config could be created that had a listener for all of the different encryption options described above and hence a large number of ways of authenticating."),(0,o.kt)("h3",{id:"general-options"},"General Options"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"acl_file")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"Set the path to an access control list file. If defined, the contents of the file are used to control client access to topics on the broker."),(0,o.kt)("p",null,"If this parameter is defined then only the topics listed will have access. Topic access is added with lines of the format:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"topic [read|write|readwrite|deny] <topic>")),(0,o.kt)("p",null,'The access type is controlled using "read", "write", "readwrite" or "deny". This parameter is optional (unless ',(0,o.kt)("inlineCode",{parentName:"p"},"<topic>")," includes a space character) - if not given then the access is read/write. ",(0,o.kt)("inlineCode",{parentName:"p"},"<topic>"),' can contain the + or # wildcards as in subscriptions. The "deny" option can used to explicitly deny access to a topic that would otherwise be granted by a broader read/write/readwrite statement. Any "deny" topics are handled before topics that grant read/write access.'),(0,o.kt)("p",null,"The first set of topics are applied to anonymous clients, assuming ",(0,o.kt)("inlineCode",{parentName:"p"},"allow_anonymous")," is true. User specific topic ACLs are added after a user line as follows:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"user <username>")),(0,o.kt)("p",null,"The username referred to here is the same as in ",(0,o.kt)("inlineCode",{parentName:"p"},"password_file"),". It is not the clientid."),(0,o.kt)("p",null,"It is also possible to define ACLs based on pattern substitution within the topic. The form is the same as for the topic keyword, but using pattern as the keyword."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"pattern [read|write|readwrite|deny] <topic>")),(0,o.kt)("p",null,"The patterns available for substition are:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"%c to match the client id of the client"),(0,o.kt)("li",{parentName:"ul"},"%u to match the username of the client")),(0,o.kt)("p",null,'The substitution pattern must be the only text for that level of hierarchy. Pattern ACLs apply to all users even if the "user" keyword has previously been given.'),(0,o.kt)("p",null,"Example:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"pattern write sensor/%u/data")),(0,o.kt)("p",null,"Allow access for bridge connection messages:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"pattern write $SYS/broker/connection/%c/state")),(0,o.kt)("p",null,"If the first character of a line of the ACL file is a # it is treated as a comment."),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", this option applies to the current listener being configured only. If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", this option applies to all listeners."),(0,o.kt)("p",null,"Reloaded on reload signal. The currently loaded ACLs will be freed and reloaded. Existing subscriptions will be affected after the reload."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"allow_anonymous")," ","["," true | false ","]"),(0,o.kt)("p",null,"Boolean value that determines whether clients that connect without providing a username are allowed to connect. If set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false"))," then another means of connection should be created to control authenticated client access."),(0,o.kt)("p",null,"Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", unless no listeners are defined in the configuration file, in which case it set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", but connections are only allowed from the local machine."),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", this option applies to the current listener being configured only. If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", this option applies to all listeners."),(0,o.kt)("h4",{id:"important"},"Important"),(0,o.kt)("p",null,"In version 1.6.x and earlier, this option defaulted to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true"))," unless there was another security option set."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"allow_duplicate_messages")," ","["," true | false ","]"),(0,o.kt)("p",null,"This option is deprecated and will be removed in a future version. The behavior will default to true."),(0,o.kt)("p",null,"If a client is subscribed to multiple subscriptions that overlap, e.g. foo/# and foo/+/baz , then MQTT expects that when the broker receives a message on a topic that matches both subscriptions, such as foo/bar/baz, then the client should only receive the message once."),(0,o.kt)("p",null,"Eclipse Mosquitto keeps track of which clients a message has been sent to in order to meet this requirement. This option allows this behavior to be disabled, which may be useful if you have a large number of clients subscribed to the same set of topics and want to minimize memory usage."),(0,o.kt)("p",null,"It can be safely set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true"))," if you know in advance that your clients will never have overlapping subscriptions, otherwise your clients must be able to correctly deal with duplicate messages even when then have QoS=2."),(0,o.kt)("p",null,"Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),"."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"allow_zero_length_clientid")," ","["," true | false ","]"),(0,o.kt)("p",null,"MQTT 3.1.1 and MQTT 5 allow clients to connect with a zero length client id and have the broker generate a client id for them. Use this option to allow/disallow this behavior. Defaults to true."),(0,o.kt)("p",null,"See also the ",(0,o.kt)("inlineCode",{parentName:"p"},"auto_id_prefix")," option."),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", this option applies to the current listener being configured only. If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", this option applies to all listeners."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"auth_opt_*")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"value"))),(0,o.kt)("p",null,"Options to be passed to the auth plugin. See the specific plugin instructions."),(0,o.kt)("p",null,"Applies to the current authentication plugin being configured."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"auth_plugin")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"Specify an external module to use for authentication and access control. This allows custom username/password and access control functions to be created."),(0,o.kt)("p",null,"Can be specified multiple times to load multiple plugins. The plugins will be processed in the order that they are specified."),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"password_file"),", or ",(0,o.kt)("inlineCode",{parentName:"p"},"acl_file")," are used in the config file alongside ",(0,o.kt)("inlineCode",{parentName:"p"},"auth_plugin"),", the plugin checks will run after the built-in checks."),(0,o.kt)("p",null,"Not currently reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"auth_plugin_deny_special_chars")," ","["," true | false ","]"),(0,o.kt)("p",null,"If ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true"))," then before an ACL check is made, the username/client id of the client needing the check is searched for the presence of either a '+' or '#' character. If either of these characters is found in either the username or client id, then the ACL check is denied before it is sent to the plugin."),(0,o.kt)("p",null,"This check prevents the case where a malicious user could circumvent an ACL check by using one of these characters as their username or client id. This is the same issue as was reported with mosquitto itself as CVE-2017-7650."),(0,o.kt)("p",null,"If you are entirely sure that the plugin you are using is not vulnerable to this attack (i.e. if you never use usernames or client ids in topics) then you can disable this extra check and hence have all ACL checks delivered to your plugin by setting this option to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),"."),(0,o.kt)("p",null,"Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),"."),(0,o.kt)("p",null,"Applies to the current authentication plugin being configured."),(0,o.kt)("p",null,"Not currently reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"auto_id_prefix")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"prefix"))),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"allow_zero_length_clientid")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", this option allows you to set a string that will be prefixed to the automatically generated client ids to aid visibility in logs. Defaults to ",(0,o.kt)("inlineCode",{parentName:"p"},"auto-"),"."),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", this option applies to the current listener being configured only. If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", this option applies to all listeners."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"autosave_interval")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"seconds"))),(0,o.kt)("p",null,"The number of seconds that mosquitto will wait between each time it saves the in-memory database to disk. If set to 0, the in-memory database will only be saved when mosquitto exits or when receiving the SIGUSR1 signal. Note that this setting only has an effect if persistence is enabled. Defaults to 1800 seconds (30 minutes)."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"autosave_on_changes")," ","["," true | false ","]"),(0,o.kt)("p",null,"If ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", mosquitto will count the number of subscription changes, retained messages received and queued messages and if the total exceeds ",(0,o.kt)("inlineCode",{parentName:"p"},"autosave_interval")," then the in-memory database will be saved to disk. If ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", mosquitto will save the in-memory database to disk by treating ",(0,o.kt)("inlineCode",{parentName:"p"},"autosave_interval")," as a time in seconds."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"check_retain_source")," ","["," true | false ","]"),(0,o.kt)("p",null,"This option affects the scenario when a client subscribes to a topic that has retained messages. It is possible that the client that published the retained message to the topic had access at the time they published, but that access has been subsequently removed. If ",(0,o.kt)("inlineCode",{parentName:"p"},"check_retain_source")," is set to true, the default, the source of a retained message will be checked for access rights before it is republished. When set to false, no check will be made and the retained message will always be published."),(0,o.kt)("p",null,"This option applies globally, regardless of the ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," option."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"clientid_prefixes")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"prefix"))),(0,o.kt)("p",null,"This option is deprecated and will be removed in a future version."),(0,o.kt)("p",null,"If defined, only clients that have a clientid with a prefix that matches clientid","_",'prefixes will be allowed to connect to the broker. For example, setting "secure-" here would mean a client "secure-client" could connect but another with clientid "mqtt" couldn\'t. By default, all client ids are valid.'),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal. Note that currently connected clients will be unaffected by any changes."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"connection_messages")," ","["," true | false ","]"),(0,o.kt)("p",null,"If set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", the log will include entries when clients connect and disconnect. If set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", these entries will not appear."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"include_dir")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"dir"))),(0,o.kt)("p",null,"External configuration files may be included by using the include","_","dir option. This defines a directory that will be searched for config files. All files that end in '.conf' will be loaded as a configuration file. It is best to have this as the last option in the main file. This option will only be processed from the main configuration file. The directory specified must not contain the main configuration file."),(0,o.kt)("p",null,"The configuration files in ",(0,o.kt)("inlineCode",{parentName:"p"},"include_dir")," are loaded in case-sensitive alphabetical order, with the upper case of each letter ordered before the lower case of the same letter."),(0,o.kt)("p",null,"Example Load Order for include","_","dir."),(0,o.kt)("p",null,"Given the files ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"b.conf")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"A.conf")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"01.conf")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"a.conf")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"B.conf")),", and ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"00.conf"))," inside ",(0,o.kt)("inlineCode",{parentName:"p"},"include_dir"),", the config files would be loaded in this order:"),(0,o.kt)("p",null,"00.conf\n01.conf\nA.conf\na.conf\nB.conf\nb.conf"),(0,o.kt)("p",null,"If this option is used multiple times, then each ",(0,o.kt)("inlineCode",{parentName:"p"},"include_dir")," option is processed completely in the order that they are written in the main configuration file."),(0,o.kt)("p",null,"Example Load Order for Multiple include","_","dir."),(0,o.kt)("p",null,"Assuming a directory ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"one.d"))," containing files ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"B.conf"))," and ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"C.conf")),", and a second directory ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"two.d"))," containing files ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"A.conf"))," and ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"D.conf")),", and a config:"),(0,o.kt)("p",null,"include","_","dir one.d\ninclude","_","dir two.d"),(0,o.kt)("p",null,"Then the config files would be loaded in this order:"),(0,o.kt)("p",null,"#"," files from one.d\nB.conf\nC.conf"),(0,o.kt)("h1",{id:"files-from-twod"},"files from two.d"),(0,o.kt)("p",null,"A.conf\nD.conf"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"log_dest")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"destinations"))),(0,o.kt)("p",null,"Send log messages to a particular destination. Possible destinations are: ",(0,o.kt)("inlineCode",{parentName:"p"},"stdout")," ",(0,o.kt)("inlineCode",{parentName:"p"},"stderr")," ",(0,o.kt)("inlineCode",{parentName:"p"},"syslog")," ",(0,o.kt)("inlineCode",{parentName:"p"},"topic")," ",(0,o.kt)("inlineCode",{parentName:"p"},"file")," ",(0,o.kt)("inlineCode",{parentName:"p"},"dlt"),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"stdout")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"stderr")," log to the console on the named output."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"syslog")," uses the user space syslog facility which usually ends up in /var/log/messages or similar."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"topic")," logs to the broker topic ",(0,o.kt)("inlineCode",{parentName:"p"},"$SYS/broker/log/<severity>"),"\t, where severity is one of E, W, N, I, M which are error, warning, notice, information and message. Message type severity is used by the subscribe and unsubscribe log","_","type options and publishes log messages at $SYS/broker/log/M/subscribe and $SYS/broker/log/M/unsubscribe. Debug messages are never logged on topics."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"file"),' destination requires an additional parameter which is the file to be logged to, e.g. "log',"_",'dest file /var/log/mosquitto.log". The file will be closed and reopened when the broker receives a HUP signal. Only a single file destination may be configured.'),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"dlt")," destination is for the automotive ","`","Diagnostic Log and Trace","`"," tool. This requires that Mosquitto has been compiled with DLT support."),(0,o.kt)("p",null,'Use "log',"_",'dest none" if you wish to disable logging. Defaults to stderr. This option may be specified multiple times.'),(0,o.kt)("p",null,'Note that if the broker is running as a Windows service it will default to "log',"_",'dest none" and neither stdout nor stderr logging is available.'),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"log_facility")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"local facility"))),(0,o.kt)("p",null,'If using syslog logging (not on Windows), messages will be logged to the "daemon" facility by default. Use the ',(0,o.kt)("inlineCode",{parentName:"p"},"log_facility"),' option to choose which of local0 to local7 to log to instead. The option value should be an integer value, e.g. "log',"_",'facility 5" to use local5.'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"log_timestamp")," ","["," true | false ","]"),(0,o.kt)("p",null,"Boolean value, if set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true"))," a timestamp value will be added to each log entry. The default is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),"."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"log_timestamp_format")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"format"))),(0,o.kt)("p",null,"Set the format of the log timestamp. If left unset, this is the number of seconds since the Unix epoch. This option is a free text string which will be passed to the strftime function as the format specifier. To get an ISO 8601 datetime, for example:"),(0,o.kt)("p",null,"log","_","timestamp","_","format %Y-%m-%dT%H:%M:%S"),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"log_type")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"types"))),(0,o.kt)("p",null,"Choose types of messages to log. Possible types are: ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"debug")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"error")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"warning")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"notice")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"information")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"subscribe")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"unsubscribe")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"websockets")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"none")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"all")),"."),(0,o.kt)("p",null,"Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"error")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"warning")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"notice"))," and ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"information")),". This option may be specified multiple times. Note that the ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"debug"))," type (used for decoding incoming/outgoing network packets) is never logged in topics."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"max_inflight_bytes")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"count"))),(0,o.kt)("p",null,"Outgoing QoS 1 and 2 messages will be allowed in flight until this byte limit is reached. This allows control of outgoing message rate based on message size rather than message count. If the limit is set to 100, messages of over 100 bytes are still allowed, but only a single message can be in flight at once. Defaults to 0. (No limit)."),(0,o.kt)("p",null,"See also the ",(0,o.kt)("inlineCode",{parentName:"p"},"max_inflight_messages")," option."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"max_inflight_messages")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"count"))),(0,o.kt)("p",null,"The maximum number of outgoing QoS 1 or 2 messages that can be in the process of being transmitted simultaneously. This includes messages currently going through handshakes and messages that are being retried. Defaults to 20. Set to 0 for no maximum. If set to 1, this will guarantee in-order delivery of messages."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"max_keepalive")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"value"))),(0,o.kt)("p",null,'For MQTT v5 clients, it is possible to have the server send a "server keepalive" value that will override the keepalive value set by the client. This is intended to be used as a mechanism to say that the server will disconnect the client earlier than it anticipated, and that the client should use the new keepalive value. The max',"_","keepalive option allows you to specify that clients may only connect with keepalive less than or equal to this value, otherwise they will be sent a server keepalive telling them to use max","_","keepalive. This only applies to MQTT v5 clients. The maximum value allowable, and default value, is 65535. Do not set below 10 seconds."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"max_packet_size")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"value"))),(0,o.kt)("p",null,'For MQTT v5 clients, it is possible to have the server send a "maximum packet size" value that will instruct the client it will not accept MQTT packets with size greater than ',(0,o.kt)("inlineCode",{parentName:"p"},"value")," bytes. This applies to the full MQTT packet, not just the payload. Setting this option to a positive value will set the maximum packet size to that number of bytes. If a client sends a packet which is larger than this value, it will be disconnected. This applies to all clients regardless of the protocol version they are using, but v3.1.1 and earlier clients will of course not have received the maximum packet size information. Defaults to no limit."),(0,o.kt)("p",null,"This option applies to all clients, not just those using MQTT v5, but it is not possible to notify clients using MQTT v3.1.1 or MQTT v3.1 of the limit."),(0,o.kt)("p",null,"Setting below 20 bytes is forbidden because it is likely to interfere with normal client operation even with small payloads."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"max_queued_bytes")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"count"))),(0,o.kt)("p",null,"The number of outgoing QoS 1 and 2 messages above those currently in-flight will be queued (per client) by the broker. Once this limit has been reached, subsequent messages will be silently dropped. This is an important option if you are sending messages at a high rate and/or have clients who are slow to respond or may be offline for extended periods of time. Defaults to 0. (No maximum)."),(0,o.kt)("p",null,"See also the ",(0,o.kt)("inlineCode",{parentName:"p"},"max_queued_messages")," option. If both max","_","queued","_","messages and max","_","queued","_","bytes are specified, packets will be queued until the first limit is reached."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"max_queued_messages")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"count"))),(0,o.kt)("p",null,"The maximum number of QoS 1 or 2 messages to hold in the queue (per client) above those messages that are currently in flight. Defaults to 1000. Set to 0 for no maximum (not recommended). See also the ",(0,o.kt)("inlineCode",{parentName:"p"},"queue_qos0_messages")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"max_queued_bytes")," options."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"memory_limit")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"limit"))),(0,o.kt)("p",null,"This option sets the maximum number of heap memory bytes that the broker will allocate, and hence sets a hard limit on memory use by the broker. Memory requests that exceed this value will be denied. The effect will vary depending on what has been denied. If an incoming message is being processed, then the message will be dropped and the publishing client will be disconnected. If an outgoing message is being sent, then the individual message will be dropped and the receiving client will be disconnected. Defaults to no limit."),(0,o.kt)("p",null,"This option is only available if memory tracking support is compiled in."),(0,o.kt)("p",null,"Reloaded on reload signal. Setting to a lower value and reloading will not result in memory being freed."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"message_size_limit")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"limit"))),(0,o.kt)("p",null,'This option sets the maximum publish payload size that the broker will allow. Received messages that exceed this size will not be accepted by the broker. This means that the message will not be forwarded on to subscribing clients, but the QoS flow will be completed for QoS 1 or QoS 2 messages. MQTT v5 clients using QoS 1 or QoS 2 will receive a PUBACK or PUBREC with the "implementation specific error" reason code.'),(0,o.kt)("p",null,"The default value is 0, which means that all valid MQTT messages are accepted. MQTT imposes a maximum payload size of 268435455 bytes."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"password_file")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"Set the path to a password file. If defined, the contents of the file are used to control client access to the broker. The file can be created using the ",(0,o.kt)("a",{parentName:"p",href:"./manpage-mosquitto-passwd"},"mosquitto","_","passwd(1)"),' utility. If mosquitto is compiled without TLS support (it is recommended that TLS support is included), then the password file should be a text file with each line in the format "username:password", where the colon and password are optional but recommended. If ',(0,o.kt)("inlineCode",{parentName:"p"},"allow_anonymous")," is set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", only users defined in this file will be able to connect. Setting ",(0,o.kt)("inlineCode",{parentName:"p"},"allow_anonymous")," to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true"))," when _",(0,o.kt)("inlineCode",{parentName:"p"},"password_file"),"_is defined is valid and could be used with acl","_","file to have e.g. read only guest/anonymous accounts and defined users that can publish."),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", this option applies to the current listener being configured only. If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", this option applies to all listeners."),(0,o.kt)("p",null,"Reloaded on reload signal. The currently loaded username and password data will be freed and reloaded. Clients that are already connected will not be affected."),(0,o.kt)("p",null,"See also ",(0,o.kt)("a",{parentName:"p",href:"./manpage-mosquitto-passwd"},"mosquitto","_","passwd(1)"),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," ","["," true | false ","]"),(0,o.kt)("p",null,"If ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", then authentication and access control settings will be controlled on a per-listener basis. The following options are affected:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"password_file"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"acl_file"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"psk_file"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"allow_anonymous"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"allow_zero_length_clientid"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"auth_plugin"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"auth_opt_*"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"auto_id_prefix"),"."),(0,o.kt)("p",null,"Note that if set to true, then a durable client (i.e. with clean session set to false) that has disconnected will use the ACL settings defined for the listener that it was most recently connected to."),(0,o.kt)("p",null,"The default behavior is for this to be set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", which maintains the settings behavior from previous versions of mosquitto."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"persistence")," ","["," true | false ","]"),(0,o.kt)("p",null,"If ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", connection, subscription and message data will be written to the disk in mosquitto.db at the location dictated by persistence","_","location. When mosquitto is restarted, it will reload the information stored in mosquitto.db. The data will be written to disk when mosquitto closes and also at periodic intervals as defined by autosave","_","interval. Writing of the persistence database may also be forced by sending mosquitto the SIGUSR1 signal. If ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", the data will be stored in memory only. Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),"."),(0,o.kt)("p",null,"The persistence file may change its format in a new version. The broker can currently read all old formats, but will only save in the latest format. It should always be safe to upgrade, but cautious users may wish to take a copy of the persistence file before installing a new version so that they can roll back to an earlier version if necessary."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"persistence_file")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file name"))),(0,o.kt)("p",null,"The filename to use for the persistent database. Defaults to mosquitto.db."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"persistence_location")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"path"))),(0,o.kt)("p",null,"The path where the persistence database should be stored. Must end in a trailing slash. If not given, then the current directory is used."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"persistent_client_expiration")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"duration"))),(0,o.kt)("p",null,"This option allows persistent clients (those with clean session set to false) to be removed if they do not reconnect within a certain time frame. This is a non-standard option. As far as the MQTT spec is concerned, persistent clients persist forever."),(0,o.kt)("p",null,"Badly designed clients may set clean session to false whilst using a randomly generated client id. This leads to persistent clients that will never reconnect. This option allows these clients to be removed."),(0,o.kt)("p",null,"The expiration period should be an integer followed by one of h d w m y for hour, day, week, month and year respectively. For example:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"persistent","_","client","_","expiration 2m"),(0,o.kt)("li",{parentName:"ul"},"persistent","_","client","_","expiration 14d"),(0,o.kt)("li",{parentName:"ul"},"persistent","_","client","_","expiration 1y")),(0,o.kt)("p",null,"As this is a non-standard option, the default if not set is to never expire persistent clients."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"pid_file")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"Write a pid file to the file specified. If not given (the default), no pid file will be written. If the pid file cannot be written, mosquitto will exit."),(0,o.kt)("p",null,"If mosquitto is being automatically started by an init script it will usually be required to write a pid file. This should then be configured as e.g. /var/run/mosquitto.pid"),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"psk_file")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,'Set the path to a pre-shared-key file. This option requires a listener to be have PSK support enabled. If defined, the contents of the file are used to control client access to the broker. Each line should be in the format "identity:key", where the key is a hexadecimal string with no leading "0x". A client connecting to a listener that has PSK support enabled must provide a matching identity and PSK to allow the encrypted connection to proceed.'),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", this option applies to the current listener being configured only. If ",(0,o.kt)("inlineCode",{parentName:"p"},"per_listener_settings")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", this option applies to all listeners."),(0,o.kt)("p",null,"Reloaded on reload signal. The currently loaded identity and key data will be freed and reloaded. Clients that are already connected will not be affected."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"queue_qos0_messages")," ","["," true | false ","]"),(0,o.kt)("p",null,"Set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true"))," to queue messages with QoS 0 when a persistent client is disconnected. These messages are included in the limit imposed by max","_","queued","_","messages. Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),"."),(0,o.kt)("p",null,"Note that the MQTT v3.1.1 spec states that only QoS 1 and 2 messages should be saved in this situation so this is a non-standard option."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"retain_available")," ","["," true | false ","]"),(0,o.kt)("p",null,"If set to false, then retained messages are not supported. Clients that send a message with the retain bit will be disconnected if this option is set to false. Defaults to true."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"set_tcp_nodelay")," ","["," true | false ","]"),(0,o.kt)("p",null,"If set to true, the TCP","_","NODELAY option will be set on client sockets to disable Nagle's algorithm. This has the effect of reducing latency of some messages at potentially increasing the number of TCP packets being sent. Defaults to false."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"sys_interval")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"seconds"))),(0,o.kt)("p",null,"The integer number of seconds between updates of the $SYS subscription hierarchy, which provides status information about the broker. If unset, defaults to 10 seconds."),(0,o.kt)("p",null,"Set to 0 to disable publishing the $SYS hierarchy completely."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"upgrade_outgoing_qos")," ","["," true | false ","]"),(0,o.kt)("p",null,"The MQTT specification requires that the QoS of a message delivered to a subscriber is never upgraded to match the QoS of the subscription. Enabling this option changes this behaviour. If ",(0,o.kt)("inlineCode",{parentName:"p"},"upgrade_outgoing_qos")," is set ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", messages sent to a subscriber will always match the QoS of its subscription. This is a non-standard option not provided for by the spec. Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),"."),(0,o.kt)("p",null,"This option applies globally."),(0,o.kt)("p",null,"Reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"user")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"username"))),(0,o.kt)("p",null,'When run as root, change to this user and its primary group on startup. If set to "mosquitto" or left unset, and if the "mosquitto" user does not exist, then mosquitto will change to the "nobody" user instead. If this is set to another value and mosquitto is unable to change to this user and group, it will exit with an error. The user specified must have read/write access to the persistence database if it is to be written. If run as a non-root user, this setting has no effect. Defaults to mosquitto.'),(0,o.kt)("p",null,"This setting has no effect on Windows and so you should run mosquitto as the user you wish it to run as."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("h3",{id:"listeners"},"Listeners"),(0,o.kt)("p",null,"The network ports that mosquitto listens on can be controlled using listeners. The default listener options can be overridden and further listeners can be created."),(0,o.kt)("h4",{id:"general-options-1"},"General Options"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bind_address")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"address"))),(0,o.kt)("p",null,"This option is deprecated and will be removed in a future version. Use the ",(0,o.kt)("inlineCode",{parentName:"p"},"listener")," instead."),(0,o.kt)("p",null,'Listen for incoming network connections on the specified IP address/hostname only. This is useful to restrict access to certain network interfaces. To restrict access to mosquitto to the local host only, use "bind',"_",'address localhost". This only applies to the default listener. Use the ',(0,o.kt)("inlineCode",{parentName:"p"},"listener")," option to control other listeners."),(0,o.kt)("p",null,"It is recommended to use an explicit ",(0,o.kt)("inlineCode",{parentName:"p"},"listener")," rather than rely on the implicit default listener options like this."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bind_interface")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"device"))),(0,o.kt)("p",null,"Listen for incoming network connections only on the specified interface. This is similar to the ",(0,o.kt)("inlineCode",{parentName:"p"},"bind_address")," option but is useful when an interface has multiple addresses or the address may change."),(0,o.kt)("p",null,"It is valid to use this option together with ",(0,o.kt)("inlineCode",{parentName:"p"},"bind_address")," for the default listener, or the ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"bind address/host"))," part of the ",(0,o.kt)("inlineCode",{parentName:"p"},"listener")," definition. Care should be taken to ensure that the address being bound to is on the interface being bound to. If you set the ",(0,o.kt)("inlineCode",{parentName:"p"},"bind_interface")," to be ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"eth0")),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"bind_address")," to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"127.0.0.1")),", then the broker will start correctly but you will be unable to connect."),(0,o.kt)("p",null,"This option is currently only available on Linux, and requires elevated privileges."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"http_dir")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"directory"))),(0,o.kt)("p",null,"When a listener is using the websockets protocol, it is possible to serve http data as well. Set ",(0,o.kt)("inlineCode",{parentName:"p"},"http_dir")," to a directory which contains the files you wish to serve. If this option is not specified, then no normal http connections will be possible."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"listener")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"port"))," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"[bind address/host/unix socket path]"))),(0,o.kt)("p",null,"Listen for incoming network connection on the specified port. A second optional argument allows the listener to be bound to a specific ip address/hostname. If this variable is used and neither the global ",(0,o.kt)("inlineCode",{parentName:"p"},"bind_address")," nor ",(0,o.kt)("inlineCode",{parentName:"p"},"port")," options are used then the default listener will not be started."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"bind address/host")," option allows this listener to be bound to a specific IP address by passing an IP address or hostname. For websockets listeners, it is only possible to pass an IP address here."),(0,o.kt)("p",null,"On systems that support Unix Domain Sockets, this option can also be used to create a Unix socket rather than opening a TCP socket. In this case, the port must be set to 0, and the unix socket path must be given."),(0,o.kt)("p",null,"This option may be specified multiple times. See also the ",(0,o.kt)("inlineCode",{parentName:"p"},"mount_point")," option."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"max_connections")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"count"))),(0,o.kt)("p",null,"Limit the total number of clients connected for the current listener. Set to ",(0,o.kt)("inlineCode",{parentName:"p"},"-1"),' to have "unlimited" connections. Note that other limits may be imposed that are outside the control of mosquitto. See e.g. ',(0,o.kt)("a",{parentName:"p",href:"https://linux.die.net/man/5/limits.conf"},"limits.conf(5)"),"."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"max_qos")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"value"))),(0,o.kt)("p",null,"Limit the QoS value allowed for clients connecting to this listener. Defaults to 2, which means any QoS can be used. Set to 0 or 1 to limit to those QoS values. This makes use of an MQTT v5 feature to notify clients of the limitation. MQTT v3.1.1 clients will not be aware of the limitation. Clients publshing to this listener with a too-high QoS will be disconnected."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"max_topic_alias")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"number"))),(0,o.kt)("p",null,"This option sets the maximum number topic aliases that an MQTT v5 client is allowed to create. This option applies per listener. Defaults to 10. Set to 0 to disallow topic aliases. The maximum value possible is 65535."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"mount_point")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"topic prefix"))),(0,o.kt)("p",null,"This option is used with the listener option to isolate groups of clients. When a client connects to a listener which uses this option, the string argument is attached to the start of all topics for this client. This prefix is removed when any messages are sent to the client. This means a client connected to a listener with mount point ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"example"))," can only see messages that are published in the topic hierarchy ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"example"))," and below."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"port")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"port number"))),(0,o.kt)("p",null,"This option is deprecated and will be removed in a future version. Use the ",(0,o.kt)("inlineCode",{parentName:"p"},"listener")," instead."),(0,o.kt)("p",null,"Set the network port for the default listener to listen on. Defaults to 1883."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,"It is recommended to use an explicit ",(0,o.kt)("inlineCode",{parentName:"p"},"listener")," rather than rely on the implicit default listener options like this."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"protocol")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"value"))),(0,o.kt)("p",null,"Set the protocol to accept for the current listener. Can be ",(0,o.kt)("inlineCode",{parentName:"p"},"mqtt"),", the default, or ",(0,o.kt)("inlineCode",{parentName:"p"},"websockets")," if available."),(0,o.kt)("p",null,"Websockets support is currently disabled by default at compile time. Certificate based TLS may be used with websockets, except that only the ",(0,o.kt)("inlineCode",{parentName:"p"},"cafile"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"certfile"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"keyfile"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"ciphers"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"ciphers_tls1.3")," options are supported."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"socket_domain")," ","["," ipv4 | ipv6 ","]"),(0,o.kt)("p",null,"By default, a listener will attempt to listen on all supported IP protocol versions. If you do not have an IPv4 or IPv6 interface you may wish to disable support for either of those protocol versions. In particular, note that due to the limitations of the websockets library, it will only ever attempt to open IPv6 sockets if IPv6 support is compiled in, and so will fail if IPv6 is not available."),(0,o.kt)("p",null,"Set to ",(0,o.kt)("inlineCode",{parentName:"p"},"ipv4")," to force the listener to only use IPv4, or set to ",(0,o.kt)("inlineCode",{parentName:"p"},"ipv6")," to force the listener to only use IPv6. If you want support for both IPv4 and IPv6, then do not use the ",(0,o.kt)("inlineCode",{parentName:"p"},"socket_domain")," option."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"use_username_as_clientid")," ","["," true | false ","]"),(0,o.kt)("p",null,"Set ",(0,o.kt)("inlineCode",{parentName:"p"},"use_username_as_clientid")," to true to replace the clientid that a client connected with its username. This allows authentication to be tied to the clientid, which means that it is possible to prevent one client disconnecting another by using the same clientid. Defaults to false."),(0,o.kt)("p",null,"If a client connects with no username it will be disconnected as not authorised when this option is set to true. Do not use in conjunction with ",(0,o.kt)("inlineCode",{parentName:"p"},"clientid_prefixes"),"."),(0,o.kt)("p",null,"See also ",(0,o.kt)("inlineCode",{parentName:"p"},"use_identity_as_username"),"."),(0,o.kt)("p",null,"Not reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"websockets_log_level")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"level"))),(0,o.kt)("p",null,"Change the websockets logging level. This is a global option, it is not possible to set per listener. This is an integer that is interpreted by libwebsockets as a bit mask for its lws","_","log","_","levels enum. See the libwebsockets documentation for more details."),(0,o.kt)("p",null,"To use this option, ",(0,o.kt)("inlineCode",{parentName:"p"},"log_type websockets")," must also be enabled. Defaults to 0."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"websockets_headers_size")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"size"))),(0,o.kt)("p",null,"Change the websockets headers size. This is a global option, it is not possible to set per listener. This option sets the size of the buffer used in the libwebsockets library when reading HTTP headers. If you are passing large header data such as cookies then you may need to increase this value. If left unset, or set to 0, then the default of 1024 bytes will be used."),(0,o.kt)("h4",{id:"certificate-based-ssltls-support"},"Certificate based SSL/TLS Support"),(0,o.kt)("p",null,'The following options are available for all listeners to configure certificate based SSL support. See also "Pre-shared-key based SSL/TLS support".'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"cafile")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"cafile")," is used to define the path to a file containing the PEM encoded CA certificates that are trusted when checking incoming client certificates."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"capath")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"directory path"))),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"capath")," is used to define a directory that contains PEM encoded CA certificates that are trusted when checking incoming client certificates. For ",(0,o.kt)("inlineCode",{parentName:"p"},"capath"),' to work correctly, the certificates files must have ".pem" as the file ending and you must run "openssl rehash ',(0,o.kt)("inlineCode",{parentName:"p"},"<path to capath"),'" each time you add/remove a certificate.'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"certfile")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"Path to the PEM encoded server certificate. This option and ",(0,o.kt)("inlineCode",{parentName:"p"},"keyfile")," must be present to enable certificate based TLS encryption."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"ciphers")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"cipher:list"))),(0,o.kt)("p",null,'The list of allowed ciphers for this listener, for TLS v1.2 and earlier only, each separated with a colon. Available ciphers can be obtained using the "openssl ciphers" command.'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"ciphers_tls1.3")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"cipher:list"))),(0,o.kt)("p",null,"The list of allowed ciphersuites for this listener, for TLS v1.3, each separated with a colon."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"crlfile")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"If you have ",(0,o.kt)("inlineCode",{parentName:"p"},"require_certificate")," set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", you can create a certificate revocation list file to revoke access to particular client certificates. If you have done this, use crlfile to point to the PEM encoded revocation file."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"dhparamfile")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"To allow the use of ephemeral DH key exchange, which provides forward security, the listener must load DH parameters. This can be specified with the dhparamfile option. The dhparamfile can be generated with the command e.g."),(0,o.kt)("p",null,"openssl dhparam -out dhparam.pem 2048"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"keyfile")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"Path to the PEM encoded server key. This option and ",(0,o.kt)("inlineCode",{parentName:"p"},"certfile")," must be present to enable certificate based TLS encryption."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"require_certificate")," ","["," true | false ","]"),(0,o.kt)("p",null,"By default an SSL/TLS enabled listener will operate in a similar fashion to a https enabled web server, in that the server has a certificate signed by a CA and the client will verify that it is a trusted certificate. The overall aim is encryption of the network traffic. By setting ",(0,o.kt)("inlineCode",{parentName:"p"},"require_certificate")," to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", a client connecting to this listener must provide a valid certificate in order for the network connection to proceed. This allows access to the broker to be controlled outside of the mechanisms provided by MQTT."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"tls_engine")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"engine"))),(0,o.kt)("p",null,"A valid openssl engine id. These can be listed with openssl engine command."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"tls_engine_kpass_sha1")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"engine_kpass_sha1"))),(0,o.kt)("p",null,"SHA1 of the private key password when using an TLS engine. Some TLS engines such as the TPM engine may require the use of a password in order to be accessed. This option allows a hex encoded SHA1 hash of the password to the engine directly, instead of the user being prompted for the password."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"tls_keyform")," ","["," pem | engine ","]"),(0,o.kt)("p",null,'Specifies the type of private key in use when making TLS connections.. This can be "pem" or "engine". This parameter is useful when a TPM module is being used and the private key has been created with it. Defaults to "pem", which means normal private key files are used.'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"tls_version")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"version"))),(0,o.kt)("p",null,"Configure the minimum version of the TLS protocol to be used for this listener. Possible values are ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"tlsv1.3")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"tlsv1.2"))," and ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"tlsv1.1")),". If left unset, the default of allowing TLS v1.3 and v1.2."),(0,o.kt)("p",null,"In Mosquitto version 1.6.x and earlier, this option set the only TLS protocol version that was allowed, rather than the minimum."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"use_identity_as_username")," ","["," true | false ","]"),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"require_certificate")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", you may set ",(0,o.kt)("inlineCode",{parentName:"p"},"use_identity_as_username")," to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true"))," to use the CN value from the client certificate as a username. If this is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", the ",(0,o.kt)("inlineCode",{parentName:"p"},"password_file")," option will not be used for this listener."),(0,o.kt)("p",null,"This takes priority over ",(0,o.kt)("inlineCode",{parentName:"p"},"use_subject_as_username")," if both are set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),"."),(0,o.kt)("p",null,"See also ",(0,o.kt)("inlineCode",{parentName:"p"},"use_subject_as_username")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"use_subject_as_username")," ","["," true | false ","]"),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"require_certificate")," is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", you may set ",(0,o.kt)("inlineCode",{parentName:"p"},"use_subject_as_username")," to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true"))," to use the complete subject value from the client certificate as a username. If this is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", the ",(0,o.kt)("inlineCode",{parentName:"p"},"password_file")," option will not be used for this listener."),(0,o.kt)("p",null,"The subject will be generated in a form similar to ",(0,o.kt)("inlineCode",{parentName:"p"},"CN=test client,OU=Production,O=Server,L=Nottingham,ST=Nottinghamshire,C=GB"),"."),(0,o.kt)("p",null,"See also ",(0,o.kt)("inlineCode",{parentName:"p"},"use_identity_as_username")),(0,o.kt)("h4",{id:"pre-shared-key-based-ssltls-support"},"Pre-shared-key based SSL/TLS Support"),(0,o.kt)("p",null,'The following options are available for all listeners to configure pre-shared-key based SSL support. See also "Certificate based SSL/TLS support".'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"ciphers")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"cipher:list"))),(0,o.kt)("p",null,'When using PSK, the encryption ciphers used will be chosen from the list of available PSK ciphers. If you want to control which ciphers are available, use this option. The list of available ciphers can be optained using the "openssl ciphers" command and should be provided in the same format as the output of that command.'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"psk_hint")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"hint"))),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"psk_hint")," option enables pre-shared-key support for this listener and also acts as an identifier for this listener. The hint is sent to clients and may be used locally to aid authentication. The hint is a free form string that doesn't have much meaning in itself, so feel free to be creative."),(0,o.kt)("p",null,"If this option is provided, see ",(0,o.kt)("inlineCode",{parentName:"p"},"psk_file")," to define the pre-shared keys to be used or create a security plugin to handle them."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"tls_version")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"version"))),(0,o.kt)("p",null,"Configure the minimum version of the TLS protocol to be used for this listener. Possible values are ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"tlsv1.3")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"tlsv1.2"))," and ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"tlsv1.1")),". If left unset, the default of allowing TLS v1.3 and v1.2."),(0,o.kt)("p",null,"In Mosquitto version 1.6.x and earlier, this option set the only TLS protocol version that was allowed, rather than the minimum."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"use_identity_as_username")," ","["," true | false ","]"),(0,o.kt)("p",null,"Set ",(0,o.kt)("inlineCode",{parentName:"p"},"use_identity_as_username")," to have the psk identity sent by the client used as its username. The username will be checked as normal, so ",(0,o.kt)("inlineCode",{parentName:"p"},"password_file")," or another means of authentication checking must be used. No password will be used."),(0,o.kt)("h3",{id:"configuring-bridges"},"Configuring Bridges"),(0,o.kt)("p",null,"Multiple bridges (connections to other brokers) can be configured using the following variables."),(0,o.kt)("p",null,"Bridges cannot currently be reloaded on reload signal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"address")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"address[:port]"))," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"[address[:port]]")),",",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("inlineCode",{parentName:"p"},"addresses")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"address[:port]"))," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"[address[:port]]"))),(0,o.kt)("p",null,"Specify the address and optionally the port of the bridge to connect to. This must be given for each bridge connection. If the port is not specified, the default of 1883 is used."),(0,o.kt)("p",null,"If you use an IPv6 address, then the port is not optional."),(0,o.kt)("p",null,"Multiple host addresses can be specified on the address config. See the ",(0,o.kt)("inlineCode",{parentName:"p"},"round_robin")," option for more details on the behaviour of bridges with multiple addresses."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_attempt_unsubscribe")," ","["," true | false ","]"),(0,o.kt)("p",null,'If a bridge has topics that have "out" direction, the default behaviour is to send an unsubscribe request to the remote broker on that topic. This means that changing a topic direction from "in" to "out" will not keep receiving incoming messages. Sending these unsubscribe requests is not always desirable, setting ',(0,o.kt)("inlineCode",{parentName:"p"},"bridge_attempt_unsubscribe")," to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false"))," will disable sending the unsubscribe request. Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_bind_address")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"ip address"))),(0,o.kt)("p",null,"If you need to have the bridge connect over a particular network interface, use bridge","_","bind","_","address to tell the bridge which local IP address the socket should bind to, e.g. ",(0,o.kt)("inlineCode",{parentName:"p"},"bridge_bind_address 192.168.1.10"),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_max_packet_size")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"value"))),(0,o.kt)("p",null,'If you wish to restrict the size of messages sent to a remote bridge, use this option. This sets the maximum number of bytes for the total message, including headers and payload. Note that MQTT v5 brokers may provide their own maximum-packet-size property. In this case, the smaller of the two limits will be used. Set to 0 for "unlimited".'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_outgoing_retain")," ","["," true | false ","]"),(0,o.kt)("p",null,"Some MQTT brokers do not allow retained messages. MQTT v5 gives a mechanism for brokers to tell clients that they do not support retained messages, but this is not possible for MQTT v3.1.1 or v3.1. If you need to bridge to a v3.1.1 or v3.1 broker that does not support retained messages, set the ",(0,o.kt)("inlineCode",{parentName:"p"},"bridge_outgoing_retain")," option to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),". This will remove the retain bit on all outgoing messages to that bridge, regardless of any other setting. Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_protocol_version")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"version"))),(0,o.kt)("p",null,"Set the version of the MQTT protocol to use with for this bridge. Can be one of ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"mqttv50")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"mqttv311"))," or ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"mqttv31")),". Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"mqttv311")),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"cleansession")," ","["," true | false ","]"),(0,o.kt)("p",null,"Set the clean session option for this bridge. Setting to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false"))," (the default), means that all subscriptions on the remote broker are kept in case of the network connection dropping. If set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", all subscriptions and messages on the remote broker will be cleaned up if the connection drops. Note that setting to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true"))," may cause a large amount of retained messages to be sent each time the bridge reconnects."),(0,o.kt)("p",null,"If you are using bridges with ",(0,o.kt)("inlineCode",{parentName:"p"},"cleansession")," set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false"))," (the default), then you may get unexpected behaviour from incoming topics if you change what topics you are subscribing to. This is because the remote broker keeps the subscription for the old topic. If you have this problem, connect your bridge with ",(0,o.kt)("inlineCode",{parentName:"p"},"cleansession")," set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", then reconnect with cleansession set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false"))," as normal."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"local_cleansession")," ","["," true | false","]"),(0,o.kt)("p",null,"The regular ",(0,o.kt)("inlineCode",{parentName:"p"},"cleansession")," covers both the local subscriptions and the remote subscriptions. local","_","cleansession allows splitting this. Setting ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false"))," will mean that the local connection will preserve subscription, independent of the remote connection."),(0,o.kt)("p",null,"Defaults to the value of bridge.cleansession unless explicitly specified."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"connection")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"name"))),(0,o.kt)("p",null,"This variable marks the start of a new bridge connection. It is also used to give the bridge a name which is used as the client id on the remote broker."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"keepalive_interval")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"seconds"))),(0,o.kt)("p",null,"Set the number of seconds after which the bridge should send a ping if no other traffic has occurred. Defaults to 60. A minimum value of 5 seconds is allowed."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"idle_timeout")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"seconds"))),(0,o.kt)("p",null,"Set the amount of time a bridge using the lazy start type must be idle before it will be stopped. Defaults to 60 seconds."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"local_clientid")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"id"))),(0,o.kt)("p",null,"Set the clientid to use on the local broker. If not defined, this defaults to ",(0,o.kt)("inlineCode",{parentName:"p"},"local.<remote_clientid>"),". If you are bridging a broker to itself, it is important that local","_","clientid and remote","_","clientid do not match."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"local_password")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"password"))),(0,o.kt)("p",null,"Configure the password to be used when connecting this bridge to the local broker. This may be important when authentication and ACLs are being used."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"local_username")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"username"))),(0,o.kt)("p",null,"Configure the username to be used when connecting this bridge to the local broker. This may be important when authentication and ACLs are being used."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"notifications")," ","["," true | false ","]"),(0,o.kt)("p",null,"If set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", publish notification messages to the local and remote brokers giving information about the state of the bridge connection. Retained messages are published to the topic $SYS/broker/connection/<remote","_","clientid>/state unless otherwise set with ",(0,o.kt)("inlineCode",{parentName:"p"},"notification_topic"),"s. If the message is 1 then the connection is active, or 0 if the connection has failed. Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),"."),(0,o.kt)("p",null,"This uses the Last Will and Testament (LWT) feature."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"notifications_local_only")," ","["," true | false ","]"),(0,o.kt)("p",null,"If set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", only publish notification messages to the local broker giving information about the state of the bridge connection. Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"notification_topic")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"topic"))),(0,o.kt)("p",null,"Choose the topic on which notifications will be published for this bridge. If not set the messages will be sent on the topic $SYS/broker/connection/<remote","_","clientid>/state."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"remote_clientid")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"id"))),(0,o.kt)("p",null,"Set the client id for this bridge connection. If not defined, this defaults to 'name.hostname', where name is the connection name and hostname is the hostname of this computer."),(0,o.kt)("p",null,'This replaces the old "clientid" option to avoid confusion with local/remote sides of the bridge. "clientid" remains valid for the time being.'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"remote_password")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"value"))),(0,o.kt)("p",null,"Configure a password for the bridge. This is used for authentication purposes when connecting to a broker that supports MQTT v3.1 and up and requires a username and/or password to connect. This option is only valid if a remote","_","username is also supplied."),(0,o.kt)("p",null,'This replaces the old "password" option to avoid confusion with local/remote sides of the bridge. "password" remains valid for the time being.'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"remote_username")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"name"))),(0,o.kt)("p",null,"Configure a username for the bridge. This is used for authentication purposes when connecting to a broker that supports MQTT v3.1 and up and requires a username and/or password to connect. See also the ",(0,o.kt)("inlineCode",{parentName:"p"},"remote_password")," option."),(0,o.kt)("p",null,'This replaces the old "username" option to avoid confusion with local/remote sides of the bridge. "username" remains valid for the time being.'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"restart_timeout")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"base cap")),",",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("inlineCode",{parentName:"p"},"restart_timeout")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"constant"))),(0,o.kt)("p",null,"Set the amount of time a bridge using the automatic start type will wait until attempting to reconnect."),(0,o.kt)("p",null,'This option can be configured to use a constant delay time in seconds, or to use a backoff mechanism based on "Decorrelated Jitter", which adds a degree of randomness to when the restart occurs, starting at the base and increasing up to the cap. Set a constant timeout of 20 seconds:'),(0,o.kt)("p",null,"restart","_","timeout 20"),(0,o.kt)("p",null,"Set backoff with a base (start value) of 10 seconds and a cap (upper limit) of 60 seconds:"),(0,o.kt)("p",null,"restart","_","timeout 10 30"),(0,o.kt)("p",null,"Defaults to jitter with a base of 5 seconds and cap of 30 seconds."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"round_robin")," ","["," true | false ","]"),(0,o.kt)("p",null,"If the bridge has more than one address given in the address/addresses configuration, the round","_","robin option defines the behaviour of the bridge on a failure of the bridge connection. If round","_","robin is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false")),", the default value, then the first address is treated as the main bridge connection. If the connection fails, the other secondary addresses will be attempted in turn. Whilst connected to a secondary bridge, the bridge will periodically attempt to reconnect to the main bridge until successful."),(0,o.kt)("p",null,"If round","_","robin is ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", then all addresses are treated as equals. If a connection fails, the next address will be tried and if successful will remain connected until it fails."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"start_type")," ","["," automatic | lazy | once ","]"),(0,o.kt)("p",null,"Set the start type of the bridge. This controls how the bridge starts and can be one of three types: ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"automatic")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"lazy"))," and ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"once")),'. Note that RSMB provides a fourth start type "manual" which isn\'t currently supported by mosquitto.'),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"automatic"))," is the default start type and means that the bridge connection will be started automatically when the broker starts and also restarted after a short delay (30 seconds) if the connection fails."),(0,o.kt)("p",null,"Bridges using the ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"lazy"))," start type will be started automatically when the number of queued messages exceeds the number set with the ",(0,o.kt)("inlineCode",{parentName:"p"},"threshold")," option. It will be stopped automatically after the time set by the ",(0,o.kt)("inlineCode",{parentName:"p"},"idle_timeout")," parameter. Use this start type if you wish the connection to only be active when it is needed."),(0,o.kt)("p",null,"A bridge using the ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"once"))," start type will be started automatically when the broker starts but will not be restarted if the connection fails."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"threshold")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"count"))),(0,o.kt)("p",null,"Set the number of messages that need to be queued for a bridge with lazy start type to be restarted. Defaults to 10 messages."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"topic")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"pattern"))," ","[","[","["," out | in | both ","]"," qos-level","]"," local-prefix remote-prefix","]"),(0,o.kt)("p",null,"Define a topic pattern to be shared between the two brokers. Any topics matching the pattern (which may include wildcards) are shared. The second parameter defines the direction that the messages will be shared in, so it is possible to import messages from a remote broker using ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"in")),", export messages to a remote broker using ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"out"))," or share messages in both directions. If this parameter is not defined, the default of ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"out"))," is used. The QoS level defines the publish/subscribe QoS level used for this topic and defaults to 0."),(0,o.kt)("p",null,"The ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"local-prefix"))," and ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"remote-prefix"))," options allow topics to be remapped when publishing to and receiving from remote brokers. This allows a topic tree from the local broker to be inserted into the topic tree of the remote broker at an appropriate place."),(0,o.kt)("p",null,"For incoming topics, the bridge will prepend the pattern with the remote prefix and subscribe to the resulting topic on the remote broker. When a matching incoming message is received, the remote prefix will be removed from the topic and then the local prefix added."),(0,o.kt)("p",null,"For outgoing topics, the bridge will prepend the pattern with the local prefix and subscribe to the resulting topic on the local broker. When an outgoing message is processed, the local prefix will be removed from the topic then the remote prefix added."),(0,o.kt)("p",null,"When using topic mapping, an empty prefix can be defined using the place marker ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},'""')),". Using the empty marker for the topic itself is also valid. The table below defines what combination of empty or value is valid. The ",(0,o.kt)("inlineCode",{parentName:"p"},"Full Local Topic")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"Full Remote Topic")," show the resulting topics that would be used on the local and remote ends of the bridge. For example, for the first table row if you publish to ",(0,o.kt)("inlineCode",{parentName:"p"},"L/topic")," on the local broker, then the remote broker will receive a message on the topic ",(0,o.kt)("inlineCode",{parentName:"p"},"R/topic"),"."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Pattern")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Local Prefix")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Remote Prefix")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Validity")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Full Local Topic")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Full Remote Topic")))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"pattern"),(0,o.kt)("td",{parentName:"tr",align:null},"L/"),(0,o.kt)("td",{parentName:"tr",align:null},"R/"),(0,o.kt)("td",{parentName:"tr",align:null},"valid"),(0,o.kt)("td",{parentName:"tr",align:null},"L/pattern"),(0,o.kt)("td",{parentName:"tr",align:null},"R/pattern")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"pattern"),(0,o.kt)("td",{parentName:"tr",align:null},"L/"),(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},"valid"),(0,o.kt)("td",{parentName:"tr",align:null},"L/pattern"),(0,o.kt)("td",{parentName:"tr",align:null},"pattern")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"pattern"),(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},"R/"),(0,o.kt)("td",{parentName:"tr",align:null},"valid"),(0,o.kt)("td",{parentName:"tr",align:null},"pattern"),(0,o.kt)("td",{parentName:"tr",align:null},"R/pattern")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"pattern"),(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},"valid (no remapping)"),(0,o.kt)("td",{parentName:"tr",align:null},"pattern"),(0,o.kt)("td",{parentName:"tr",align:null},"pattern")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},"local"),(0,o.kt)("td",{parentName:"tr",align:null},"remote"),(0,o.kt)("td",{parentName:"tr",align:null},"valid /remap single local topic to remote)"),(0,o.kt)("td",{parentName:"tr",align:null},"local"),(0,o.kt)("td",{parentName:"tr",align:null},"remote")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},"local"),(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},"invalid"),(0,o.kt)("td",{parentName:"tr",align:null}),(0,o.kt)("td",{parentName:"tr",align:null})),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},"remote"),(0,o.kt)("td",{parentName:"tr",align:null},"invalid"),(0,o.kt)("td",{parentName:"tr",align:null}),(0,o.kt)("td",{parentName:"tr",align:null})),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},'""'),(0,o.kt)("td",{parentName:"tr",align:null},"invalid"),(0,o.kt)("td",{parentName:"tr",align:null}),(0,o.kt)("td",{parentName:"tr",align:null})))),(0,o.kt)("p",null,"To remap an entire topic tree, use e.g.:"),(0,o.kt)("p",null,"topic # both 2 local/topic/ remote/topic/"),(0,o.kt)("p",null,"This option can be specified multiple times per bridge."),(0,o.kt)("p",null,"Care must be taken to ensure that loops are not created with this option. If you are experiencing high CPU load from a broker, it is possible that you have a loop where each broker is forever forwarding each other the same messages."),(0,o.kt)("p",null,"See also the ",(0,o.kt)("inlineCode",{parentName:"p"},"cleansession")," option if you have messages arriving on unexpected topics when using incoming topics."),(0,o.kt)("p",null,"Example Bridge Topic Remapping."),(0,o.kt)("p",null,"The configuration below connects a bridge to the broker at ",(0,o.kt)("inlineCode",{parentName:"p"},"test.mosquitto.org"),". It subscribes to the remote topic ",(0,o.kt)("inlineCode",{parentName:"p"},"$SYS/broker/clients/total")," and republishes the messages received to the local topic ",(0,o.kt)("inlineCode",{parentName:"p"},"test/mosquitto/org/clients/total")),(0,o.kt)("p",null,"connection test-mosquitto-org\naddress test.mosquitto.org\ncleansession true\ntopic clients/total in 0 test/mosquitto/org/ $SYS/broker/"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"try_private")," ","["," true | false ","]"),(0,o.kt)("p",null,"If try","_","private is set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),", the bridge will attempt to indicate to the remote broker that it is a bridge not an ordinary client. If successful, this means that loop detection will be more effective and that retained messages will be propagated correctly. Not all brokers support this feature so it may be necessary to set ",(0,o.kt)("inlineCode",{parentName:"p"},"try_private")," to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false"))," if your bridge does not connect properly."),(0,o.kt)("p",null,"Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true")),"."),(0,o.kt)("h4",{id:"ssltls-support"},"SSL/TLS Support"),(0,o.kt)("p",null,"The following options are available for all bridges to configure SSL/TLS support."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_alpn")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"alpn"))),(0,o.kt)("p",null,"Configure the application layer protocol negotiation option for the TLS session. Useful for brokers that support both websockets and MQTT on the same port."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_cafile")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"One of ",(0,o.kt)("inlineCode",{parentName:"p"},"bridge_cafile")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"bridge_capath")," must be provided to allow SSL/TLS support."),(0,o.kt)("p",null,"bridge","_","cafile is used to define the path to a file containing the PEM encoded CA certificates that have signed the certificate for the remote broker."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_capath")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"One of ",(0,o.kt)("inlineCode",{parentName:"p"},"bridge_capath")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"bridge_cafile")," must be provided to allow SSL/TLS support."),(0,o.kt)("p",null,"bridge","_","capath is used to define the path to a directory containing the PEM encoded CA certificates that have signed the certificate for the remote broker. For bridge","_",'capath to work correctly, the certificate files must have ".crt" as the file ending and you must run "openssl rehash ',(0,o.kt)("inlineCode",{parentName:"p"},"<path to bridge\\_capath>"),'" each time you add/remove a certificate.'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_certfile")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"Path to the PEM encoded client certificate for this bridge, if required by the remote broker."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_identity")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"identity"))),(0,o.kt)("p",null,"Pre-shared-key encryption provides an alternative to certificate based encryption. A bridge can be configured to use PSK with the ",(0,o.kt)("inlineCode",{parentName:"p"},"bridge_identity")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"bridge_psk")," options. This is the client identity used with PSK encryption. Only one of certificate and PSK based encryption can be used on one bridge at once."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_insecure")," ","["," true | false ","]"),(0,o.kt)("p",null,"When using certificate based TLS, the bridge will attempt to verify the hostname provided in the remote certificate matches the host/address being connected to. This may cause problems in testing scenarios, so ",(0,o.kt)("inlineCode",{parentName:"p"},"bridge_insecure")," may be set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true"))," to disable the hostname verification."),(0,o.kt)("p",null,"Setting this option to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"true"))," means that a malicious third party could potentially impersonate your server, so it should always be set to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"false"))," in production environments."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_keyfile")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"file path"))),(0,o.kt)("p",null,"Path to the PEM encoded private key for this bridge, if required by the remote broker."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_psk")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"key"))),(0,o.kt)("p",null,"Pre-shared-key encryption provides an alternative to certificate based encryption. A bridge can be configured to use PSK with the ",(0,o.kt)("inlineCode",{parentName:"p"},"bridge_identity")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"bridge_psk"),' options. This is the pre-shared-key in hexadecimal format with no "0x". Only one of certificate and PSK based encryption can be used on one bridge at once.'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_require_ocsp")," ","["," true | false ","]"),(0,o.kt)("p",null,"When set to true, the bridge requires OCSP on the TLS connection it opens as client."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bridge_tls_version")," ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"version"))),(0,o.kt)("p",null,"Configure the version of the TLS protocol to be used for this bridge. Possible values are ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"tlsv1.3")),", ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"tlsv1.2"))," and ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"tlsv1.1")),". Defaults to ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"em"},"tlsv1.2")),". The remote broker must support the same version of TLS for the connection to succeed."),(0,o.kt)("h3",{id:"files"},"Files"),(0,o.kt)("p",null,"mosquitto.conf"))}u.isMDXComponent=!0}}]);