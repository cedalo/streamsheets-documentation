"use strict";(self.webpackChunkstreamsheets=self.webpackChunkstreamsheets||[]).push([[17199],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>u});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},m=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),p=c(r),u=a,g=p["".concat(l,".").concat(u)]||p[u]||d[u]||o;return r?n.createElement(g,i(i({ref:t},m),{},{components:r})):n.createElement(g,i({ref:t},m))}));function u(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},62186:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>k,contentTitle:()=>u,default:()=>b,frontMatter:()=>p,metadata:()=>g,toc:()=>N});var n=r(3905),a=Object.defineProperty,o=Object.defineProperties,i=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,m=(e,t,r)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))l.call(t,r)&&m(e,r,t[r]);if(s)for(var r of s(t))c.call(t,r)&&m(e,r,t[r]);return e};const p={id:"monitoring-clusters",title:"Monitoring Clusters",sidebar_label:"Monitoring Clusters"},u=void 0,g={unversionedId:"clustering/monitoring-clusters",id:"version-3.1/clustering/monitoring-clusters",title:"Monitoring Clusters",description:"The following document provides a comprehensive list of all cluster related metrics for clustered Pro Mosquitto. Some metrics maybe available on the active leader node only.",source:"@site/mosquitto_versioned_docs/version-3.1/clustering/monitoring-clusters.md",sourceDirName:"clustering",slug:"/clustering/monitoring-clusters",permalink:"/mosquitto/clustering/monitoring-clusters",draft:!1,tags:[],version:"3.1",frontMatter:{id:"monitoring-clusters",title:"Monitoring Clusters",sidebar_label:"Monitoring Clusters"},sidebar:"someSidebar",previous:{title:"Setting Up HA Clusters",permalink:"/mosquitto/clustering/setting-up-ha-clusters"},next:{title:"Client Accounts",permalink:"/mosquitto/security/clients/"}},k={},N=[{value:"Remarks",id:"remarks",level:2}],f={toc:N};function b(e){var t,r=e,{components:a}=r,m=((e,t)=>{var r={};for(var n in e)l.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&s)for(var n of s(e))t.indexOf(n)<0&&c.call(e,n)&&(r[n]=e[n]);return r})(r,["components"]);return(0,n.kt)("wrapper",(t=d(d({},f),m),o(t,i({components:a,mdxType:"MDXLayout"}))),(0,n.kt)("p",null,"The following document provides a comprehensive list of all cluster related metrics for clustered Pro Mosquitto. Some metrics maybe available on the active leader node only.\nThe general broker metrics are described in  ",(0,n.kt)("a",d({parentName:"p"},{href:"/mosquitto/monitoring/metrics/available-metrics"}),"available broker metrics")),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",d({parentName:"tr"},{align:"center"}),(0,n.kt)("strong",{parentName:"th"},"label")),(0,n.kt)("th",d({parentName:"tr"},{align:"center"}),(0,n.kt)("strong",{parentName:"th"},"metric type")),(0,n.kt)("th",d({parentName:"tr"},{align:"center"}),(0,n.kt)("strong",{parentName:"th"},"description")))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_ha_voting_nodes")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Gauge"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of configured cluster nodes")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_ha_voting_nodes_online")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Gauge"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of online cluster nodes (available on leader only)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_stored_clients")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Gauge"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of clients in the cluster store (since 3.0.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_stored_subscriptions")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Gauge"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of subscriptions in the cluster store (since 3.0.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_stored_base_messages")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Gauge"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of base messages in the cluster store (since 3.0.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_stored_client_messages")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Gauge"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of client messages in the cluster store (since 3.0.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_stored_retain_messages")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Gauge"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of retain messages in the cluster store (since 3.0.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_stored_messages_to_delete")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Gauge"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of base  messages awaiting deletion in the cluster store (since 3.0.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_stored_num_snapshots")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Counter"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of snapshot creations (since 3.1.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_stored_snapshot_size_bytes")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Gauge"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Size of the last snapshot in bytes (since 3.1.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_raft_pending")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Gauge"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of cluster message pending raft thread processing (since 3.1.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_raft_processed")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Counter"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of cluster message processed by raft thread (since 3.1.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_raft_applied")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Counter"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of cluster message applied by raft consensus (since 3.1.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_mosquitto_pending")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Gauge"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of cluster message pending mosquitto thread processing (since 3.1.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_mosq_processed")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Counter"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Number of cluster message applied to node state (since 3.1.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_performance_mosq_changes")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Counter"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Ticks the raft thread spent adding mosquitto changes (since 3.1.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_performance_raft_internal")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Counter"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Ticks the raft thread spent with consensus management (since 3.1.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_performance_snapshots")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Counter"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Ticks the raft thread was spent creating a snapshots (since 3.1.0)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),(0,n.kt)("inlineCode",{parentName:"td"},"mosquitto_cluster_performance_idle")),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Counter"),(0,n.kt)("td",d({parentName:"tr"},{align:"center"}),"Ticks the raft thread was idle (since 3.1.0)")))),(0,n.kt)("h2",d({},{id:"remarks"}),"Remarks"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"To monitor the health state of the cluster compare the ",(0,n.kt)("inlineCode",{parentName:"li"},"mosquitto_ha_voting_nodes_online")," of the active leader to ",(0,n.kt)("inlineCode",{parentName:"li"},"mosquitto_ha_voting_nodes"),".\nThe leader should report the maximum of all reported online nodes. All other cluster member report no active nodes.\nIf the number of online nodes is lower than the configured number of nodes the cluster is degraded."),(0,n.kt)("li",{parentName:"ul"},"The frequency of the tick related counters can be obtained from the general broker metric ",(0,n.kt)("inlineCode",{parentName:"li"},"mosquitto_performance_counter_frequency"))))}b.isMDXComponent=!0}}]);