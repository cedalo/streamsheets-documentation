"use strict";(self.webpackChunkstreamsheets=self.webpackChunkstreamsheets||[]).push([[6795],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),m=c(n),d=a,h=m["".concat(s,".").concat(d)]||m[d]||p[d]||r;return n?o.createElement(h,l(l({ref:t},u),{},{components:n})):o.createElement(h,l({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var c=2;c<r;c++)l[c]=n[c];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},66219:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>g,contentTitle:()=>d,default:()=>y,frontMatter:()=>m,metadata:()=>h,toc:()=>f});var o=n(3905),a=Object.defineProperty,r=Object.defineProperties,l=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,p=(e,t)=>{for(var n in t||(t={}))s.call(t,n)&&u(e,n,t[n]);if(i)for(var n of i(t))c.call(t,n)&&u(e,n,t[n]);return e};const m={id:"mongodb",title:"MongoDB",sidebar_label:"MongoDB"},d=void 0,h={unversionedId:"guides/connections/mongodb",id:"version-3.0/guides/connections/mongodb",title:"MongoDB",description:"To store data and retrieve information Streamsheets are able to connect",source:"@site/streamsheets_versioned_docs/version-3.0/guides/connections/mongodb.md",sourceDirName:"guides/connections",slug:"/guides/connections/mongodb",permalink:"/streamsheets/guides/connections/mongodb",draft:!1,tags:[],version:"3.0",frontMatter:{id:"mongodb",title:"MongoDB",sidebar_label:"MongoDB"},sidebar:"someSidebar",previous:{title:"Connections",permalink:"/streamsheets/guides/connections/"},next:{title:"MQTT",permalink:"/streamsheets/guides/connections/mqtt"}},g={},f=[{value:"MongoDB Connection",id:"mongodb-connection",level:2},{value:"Settings",id:"settings",level:3},{value:"Logs",id:"logs",level:3},{value:"MongoDB Functions",id:"mongodb-functions",level:2},{value:"MONGO.STORE()",id:"mongostore",level:3},{value:"MONGO.QUERY()",id:"mongoquery",level:3},{value:"MONGO.DELETE()",id:"mongodelete",level:3},{value:"MONGO.COUNT()",id:"mongocount",level:3},{value:"MONGO.REPLACE()",id:"mongoreplace",level:3},{value:"MONGO.AGGREGATE()",id:"mongoaggregate",level:3}],k={toc:f};function y(e){var t,a=e,{components:u}=a,m=((e,t)=>{var n={};for(var o in e)s.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&i)for(var o of i(e))t.indexOf(o)<0&&c.call(e,o)&&(n[o]=e[o]);return n})(a,["components"]);return(0,o.kt)("wrapper",(t=p(p({},k),m),r(t,l({components:u,mdxType:"MDXLayout"}))),(0,o.kt)("p",null,"To store data and retrieve information Streamsheets are able to connect\nto a MongoDB. Here you can learn how to add a\nMongoDB to your current Streamsheets installation and use it."),(0,o.kt)("h2",p({},{id:"mongodb-connection"}),"MongoDB Connection"),(0,o.kt)("p",null,"A connection to interact with a MongoDB. "),(0,o.kt)("h3",p({},{id:"settings"}),"Settings"),(0,o.kt)("p",null,'Enter your connection details here. An account can be used to bundle the "settings" details in one place. Select an account to use these in your connection.'),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Host:")," The URL to a MongoDB instance followed by a port. (or if working with MongoDB locally for Docker the container name) "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Database:")," The database name to connect to"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Username, Password:")," To authenticate a client at a MongoDB, it is common to use a username and password to sign in. Different users can have different access rights to a database."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Authentication mechanism:")," Choose \u201cdefault\u201d to try all. Or select a specific."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Replica Set:")," A replica set in MongoDB is a group of MongoDB processes that maintain the same data set. Replica sets provide redundancy and high availability and are the basis for all production deployments."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"MongoDB",src:n(80296).Z,width:"605",height:"598"})),(0,o.kt)("h3",p({},{id:"logs"}),"Logs"),(0,o.kt)("p",null,"The Logs inform about the latest feedback of your endpoint. This can be successful or unsuccessful connection attempts. If you have trouble connecting, here is a good place to search for a reason. "),(0,o.kt)("h2",p({},{id:"mongodb-functions"}),"MongoDB Functions"),(0,o.kt)("p",null,"MongoDB can only be used via functions and not be connected to an Inbox directly. Use the target parameter of a function to connect to an Inbox (INBOX(SHEET1!)).\nStreamsheets offers Mongo-specific functions:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",p({parentName:"li"},{href:"../../functions/Connection/mongoaggregate"}),"MONGO.AGGREGATE")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",p({parentName:"li"},{href:"../../functions/Connection/mongocount"}),"MONGO.COUNT")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",p({parentName:"li"},{href:"../../functions/Connection/mongodelete"}),"MONGO.DELETE")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",p({parentName:"li"},{href:"../../functions/Connection/mongoquery"}),"MONGO.QUERY")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",p({parentName:"li"},{href:"../../functions/Connection/mongoreplace"}),"MONGO.REPLACE")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",p({parentName:"li"},{href:"/streamsheets/functions/Connection/mongostore"}),"MONGO.STORE"))),(0,o.kt)("p",null,"Choose the created connection in the functions. "),(0,o.kt)("h3",p({},{id:"mongostore"}),"MONGO.STORE()"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'=MONGO.STORE("Connection","Collection","Document")')),(0,o.kt)("p",null,"You can start storing data as soon as your MongoDB Connection is set up. Click on a cell and enter\nMONGO.STORE. Remember the calculation order of a Streamsheet (top to\nbottom, left to right). This might play a role in the structure of your\nlogic."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Connection:")," Choose the MongoDB connection you created."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Collection:")," MongoDB has different places to store data at. These are\ncalled collections. Type in the name of a collection. The collection will\nautomatically be created if it does not already exist."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Document:")," The document contains your data. It is a simple cell range\nof key and value pairs. It is also possible to order them in a\nhierarchy."),(0,o.kt)("p",null,"With every calculation, one document will be stored in the selected\ncollection."),(0,o.kt)("h3",p({},{id:"mongoquery"}),"MONGO.QUERY()"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'=MONGO.QUERY("Connection","Collection","Query","Target","ResultKeys","PageSize","Page","Sort","Timeout")')),(0,o.kt)("p",null,"To look up data from a MongoDB collection, use the function MONGO.QUERY.\nIt is possible to access all stored documents or a subset of\nthem."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Connection:")," Choose the MongoDB connection you created."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Collection:")," Type in the collection you used in the MONGO.STORE\nfunction."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Query:")," The query filters the data and only gives back documents that\nare a match or are composed of the query. Define one or more key-value\npairs the documents you are searching for have to contain. E.g., you have\nsaved a lot of customer information and now need the data for all\ncustomers with the name \u201cJulia\u201d define a horizontal cell range\ncontaining \u201cname\u201d on the left and \u201cJulia\u201d on the right. To access all\ndata, just leave this section empty."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Target:")," Define where it should display the response of the database.\nChoose a cell range or =INBOX(); =OUTBOX() as a target. Be careful. The\ncell range may be too small to display all information."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Result Keys:")," The query returns all the information saved in\na document. If you are only interested in a subset, write each key in a\ncell and enter the cell/ cell range in the Result Key field."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Page Size:")," The Page Size defines how many results will be shown in your query response per page. As a default, page 1 will be returned."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Page:")," Select the page you want to get back. Example: Enter page size =\n5 and page = 2. The query will return entries 6-10."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Sort:")," You can either sort by time using 1 and -1 or you can sort\nalphabetically by using a cell range with the key to sorting with and a 1\nor -1. 1 = descending; -1 = ascending."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Timeout:")," Tells the function how long to wait for a response from the\ndatabase(in ms)."),(0,o.kt)("h3",p({},{id:"mongodelete"}),"MONGO.DELETE()"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'=MONGO.DELETE("Connection","Collection","Query","Target","Timeout")')),(0,o.kt)("p",null,"Delete documents in a collection."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Connection:")," Choose the MongoDB connection you created."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Collection:")," Enter the collection you want to adjust entries in."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Query:")," It will delete all documents with the defined key value pair/s\nfrom the collection."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Target:")," MONGO.DELETE returns the number of objects that have been\ndeleted. To get this information, define either a cell range of at least\n2x2 or enter =INBOX()/=OUTBOX()."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Timeout:")," Tells the function how long to wait for a response from the\ndatabase(in ms)."),(0,o.kt)("h3",p({},{id:"mongocount"}),"MONGO.COUNT()"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'=MONGO.COUNT("Connection","Collection","Query","Target","Timeout")')),(0,o.kt)("p",null,"If you are interested in the number of documents stored in a collection\nuse MONGO.COUNT()."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Connection:")," Choose the MongoDB connection you created."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Collection:")," Enter the collection you want to count entries in."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Query:")," Enter a cell range of key-value pairs. All documents with the\ndefined key value pair/s will be counted."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Target:")," MONGO.COUNT returns the number of objects that have been\ncounted. To get this information, define either a cell range of at least\n1x2 or enter =INBOX()/=OUTBOX()."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Timeout:")," Tells the function how long to wait for a response from the\ndatabase(in ms)."),(0,o.kt)("h3",p({},{id:"mongoreplace"}),"MONGO.REPLACE()"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'=MONGO.REPLACE("Connection","Collection","Query","Document","Upsert")')),(0,o.kt)("p",null,"To replace data in a collection, use the MONGO.REPLACE() function."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Connection:")," Choose the MongoDB connection you created."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Collection:")," Enter the collection you want to replace entries in."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Query:")," The query searches for documents within a collection to\nreplace."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Document:")," Define a document to replace existing data with and enter\nthe cell range here."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Upsert:")," TRUE or FALSE. Upsert decides if and when a query can\xb4t be\nfound, the document is added to the collection or dismissed."),(0,o.kt)("img",{src:n(45911).Z,width:"100%"}),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Screenshot of an App storing & querying data")),(0,o.kt)("h3",p({},{id:"mongoaggregate"}),"MONGO.AGGREGATE()"),(0,o.kt)("p",null,"It is not only possible to store information and query them. MongoDB offers a variety of aggregation methods. In order to use these in a Streamsheet, you will need to work with the MONGO.AGGREGATE() function. Aggregation operators offer a variety of possibilities to interpret your data and help you generate an added value. Check out the official ",(0,o.kt)("a",p({parentName:"p"},{href:"https://www.mongodb.com/docs/manual/reference/operator/aggregation/"}),"MongoDB Documentation")," to see all operators for yourself."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Connection:")," Select a Connection, which is connected to the right MongoDB"),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Collection:")," Enter the collection you want to replace entries in."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Aggregate JSON:")," The JSON-Range containing the JSON query."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Target:")," Define the target for the output"),(0,o.kt)("p",null,"In the following example we want to analyze an existing database, where we stored the information on our customers (customerid, if they use the companies reward program and the total spent money on company products). Our goal is now to find out, if customers in the reward program have spent more money in total as other customers. To specify our search we only look for high value customers (high value customers have at least spent 1500$).\nTo translate this need into the language of MongoDB we have to create a JSON Range. Here we can use MongoDB operators to formulate our aggregation.\nWe first have to match our database entries to only list every entry with the parameter \u201cTotal spent money\u201d over 4000. Moreover, we need to form two groups. One where the parameter \u201cReward program\u201d is set to \u201cTRUE\u201d and one where it is set to \u201cFALSE\u201d. Finally, we are looking for the sum of the \u201ctotal spent money\u201d in each group, which we call \u201cTotal\u201d."),(0,o.kt)("p",null,"After finishing the JSON, we now can define the parameters of our MONGO.AGGREGATE() function."),(0,o.kt)("img",{src:n(88229).Z,width:"100%"}),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Screenshot of an App storing and aggregating data")),(0,o.kt)("p",null,"This is only a simple example. There are many more possibilities to interpret your data set. See the full list of operators ",(0,o.kt)("a",p({parentName:"p"},{href:"https://www.mongodb.com/docs/manual/reference/operator/"}),"here"),"."))}y.isMDXComponent=!0},88229:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/mongoaggregate-c1f2d1782a6111585528d4a2cf0355cd.png"},45911:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/mongofunctions-7f0714ba993ce27517419b15153991f6.png"},80296:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/MongoDBConnection-193a995a8e72e7a54e1c373d80738d4a.png"}}]);