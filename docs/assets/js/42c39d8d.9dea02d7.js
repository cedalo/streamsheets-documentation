"use strict";(self.webpackChunkstreamsheets=self.webpackChunkstreamsheets||[]).push([[3476],{83166:(e,n,t)=>{var i=t(64836);n.Z=void 0;var s=i(t(64938)),o=t(85893),a=(0,s.default)((0,o.jsx)("path",{d:"M12 2 4 5v6.09c0 5.05 3.41 9.76 8 10.91 4.59-1.15 8-5.86 8-10.91V5l-8-3zm-1.06 13.54L7.4 12l1.41-1.41 2.12 2.12 4.24-4.24 1.41 1.41-5.64 5.66z"}),"GppGood");n.Z=a},13328:(e,n,t)=>{var i=t(64836);n.Z=void 0;var s=i(t(64938)),o=t(85893),a=(0,s.default)((0,o.jsx)("path",{d:"m23 12-2.44-2.78.34-3.68-3.61-.82-1.89-3.18L12 3 8.6 1.54 6.71 4.72l-3.61.81.34 3.68L1 12l2.44 2.78-.34 3.69 3.61.82 1.89 3.18L12 21l3.4 1.46 1.89-3.18 3.61-.82-.34-3.68L23 12zm-10 5h-2v-2h2v2zm0-4h-2V7h2v6z"}),"NewReleases");n.Z=a},6617:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>g,contentTitle:()=>v,default:()=>T,frontMatter:()=>h,metadata:()=>k,toc:()=>b});var i=t(3905),s=t(78901),o=t(49044),a=Object.defineProperty,r=Object.defineProperties,l=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,p=(e,n,t)=>n in e?a(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,u=(e,n)=>{for(var t in n||(n={}))m.call(n,t)&&p(e,t,n[t]);if(d)for(var t of d(n))c.call(n,t)&&p(e,t,n[t]);return e};const h={id:"mc-monitoring-rest-api",title:"Monitoring REST API \u2b50"},v=void 0,k={unversionedId:"mc-monitoring-rest-api",id:"version-2.5/mc-monitoring-rest-api",title:"Monitoring REST API \u2b50",description:"This page describes the first version of the Monitoring REST API of the Mosquitto Management Center (MMC). This API will provide endpoints for retrieving monitoring information about the Mosquitto broker instances that are connected to the Management Center.",source:"@site/management-center_versioned_docs/version-2.5/monitoring-rest-api.md",sourceDirName:".",slug:"/mc-monitoring-rest-api",permalink:"/management-center/mc-monitoring-rest-api",draft:!1,tags:[],version:"2.5",frontMatter:{id:"mc-monitoring-rest-api",title:"Monitoring REST API \u2b50"},sidebar:"someSidebar",previous:{title:"Inspect Clients \u2b50",permalink:"/management-center/mc-inspect-clients"},next:{title:"Application Tokens \u2b50",permalink:"/management-center/mc-application-tokens"}},g={},b=[{value:"API description",id:"api-description",level:2},{value:"Data format",id:"data-format",level:3},{value:"Endpoints",id:"endpoints",level:3},{value:"Connections",id:"connections",level:3},{value:"URL and HTTP methods",id:"url-and-http-methods",level:4},{value:"Response payload",id:"response-payload",level:4},{value:"Single Connection",id:"single-connection",level:3},{value:"URL and HTTP methods",id:"url-and-http-methods-1",level:4},{value:"Response payload",id:"response-payload-1",level:4},{value:"Clusters",id:"clusters",level:3},{value:"URL and HTTP methods",id:"url-and-http-methods-2",level:4},{value:"Response payload",id:"response-payload-2",level:4},{value:"Single Cluster",id:"single-cluster",level:3},{value:"URL and HTTP methods",id:"url-and-http-methods-3",level:4},{value:"Response payload",id:"response-payload-3",level:4},{value:"Authentication",id:"authentication",level:2},{value:"Versioning",id:"versioning",level:2}],f={toc:b};function T(e){var n,t=e,{components:a}=t,p=((e,n)=>{var t={};for(var i in e)m.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(null!=e&&d)for(var i of d(e))n.indexOf(i)<0&&c.call(e,i)&&(t[i]=e[i]);return t})(t,["components"]);return(0,i.kt)("wrapper",(n=u(u({},f),p),r(n,l({components:a,mdxType:"MDXLayout"}))),(0,i.kt)(s.Z,{version:"2.5",mdxType:"SinceVersion"}),(0,i.kt)(o.Z,{mdxType:"PremiumFeature"}),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("p",null,"This page describes the first version of the Monitoring REST API of the Mosquitto Management Center (MMC). This API will provide endpoints for retrieving monitoring information about the Mosquitto broker instances that are connected to the Management Center."),(0,i.kt)("admonition",u({},{type:"info"}),(0,i.kt)("p",{parentName:"admonition"},"Monitoring API can be accessed by users with a ",(0,i.kt)("em",{parentName:"p"},"viewer")," role and higher. ",(0,i.kt)("em",{parentName:"p"},"monitroingViewer")," user has exclusive rights which allow them to access theis REST API only.")),(0,i.kt)("h2",u({},{id:"api-description"}),"API description"),(0,i.kt)("h3",u({},{id:"data-format"}),"Data format"),(0,i.kt)("p",null,"The data format used by the Monitoring REST API is JSON."),(0,i.kt)("h3",u({},{id:"endpoints"}),"Endpoints"),(0,i.kt)("h3",u({},{id:"connections"}),"Connections"),(0,i.kt)("p",null,"This endpoint will retrieve the status of all brokers."),(0,i.kt)("h4",u({},{id:"url-and-http-methods"}),"URL and HTTP methods"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"URL: ",(0,i.kt)("inlineCode",{parentName:"li"},"/api/monitoring/brokers")),(0,i.kt)("li",{parentName:"ul"},"Method: ",(0,i.kt)("inlineCode",{parentName:"li"},"GET"))),(0,i.kt)("h4",u({},{id:"response-payload"}),"Response payload"),(0,i.kt)("p",null,"The response body contains the overview information of all brokers. Each broker provides additional metrics information like the number of clients connected, the number of subscriptions and the number of messages received and sent."),(0,i.kt)("p",null,"The response payload has the following structure:"),(0,i.kt)("pre",null,(0,i.kt)("code",u({parentName:"pre"},{className:"language-json"}),'{\n  "total": 2,\n  "brokers": [\n    {\n      "id": "mosquitto1",\n      "name": "Mosquitto 1 Test Instance",\n      "status": {\n        "timestamp": 1234567,\n        "connected": false,\n        "error": {\n          "errno": -61,\n          "code": "ECONNREFUSED",\n          "syscall": "connect",\n          "address": "127.0.0.1",\n          "port": 1891\n        }\n      }\n    },\n    {\n      "id": "mosquitto2",\n      "name": "Mosquitto 2 Test Instance",\n      "status": {\n        "timestamp": 1234567,\n        "connected": true\n      },\n      "metrics": {\n        "version": "mosquitto version 2.1.0",\n        "clients": {\n          "total": "3",\n          "active": "1",\n          "connected": "1"\n        },\n        "load": {\n          "publish": {\n            "sent": {\n              "1min": "89.24",\n              "5min": "37.59",\n              "15min": "26.32"\n            }\n          },\n          "sockets": {\n            "15min": "0.87",\n            "1min": "1.96",\n            "5min": "0.74"\n          },\n          "connections": {\n            "15min": "0.87",\n            "1min": "1.96",\n            "5min": "0.74"\n          },\n          "messages": {\n            "received": {\n              "1min": "13.69",\n              "5min": "5.34",\n              "15min": "3.45"\n            },\n            "sent": {\n              "1min": "106.56",\n              "5min": "45.82",\n              "15min": "33.12"\n            }\n          },\n          "bytes": {\n            "received": {\n              "1min": "406.86",\n              "5min": "154.90",\n              "15min": "124.23"\n            },\n            "sent": {\n              "1min": "3418.76",\n              "5min": "1371.17",\n              "15min": "885.65"\n            }\n          }\n        },\n        "messages": {\n          "stored": "37",\n          "received": "195425",\n          "sent": "1207818"\n        },\n        "store": {\n          "messages": {\n            "count": "37",\n            "bytes": "200"\n          }\n        },\n        "subscriptions": {\n          "count": "7"\n        },\n        "retained messages": {\n          "count": "37"\n        },\n        "publish": {\n          "messages": {\n            "sent": "1012830"\n          },\n          "bytes": {\n            "sent": "5919457"\n          }\n        },\n        "bytes": {\n          "received": "17444986",\n          "sent": "43697617"\n        },\n        "uptime": "5367950 seconds"\n      }\n    }\n  ]\n}\n')),(0,i.kt)("h3",u({},{id:"single-connection"}),"Single Connection"),(0,i.kt)("p",null,"This endpoint will retrieve the status of a single connection."),(0,i.kt)("h4",u({},{id:"url-and-http-methods-1"}),"URL and HTTP methods"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"URL: ",(0,i.kt)("inlineCode",{parentName:"li"},"/api/monitoring/brokers/<broker-id>")),(0,i.kt)("li",{parentName:"ul"},"Method: ",(0,i.kt)("inlineCode",{parentName:"li"},"GET"))),(0,i.kt)("h4",u({},{id:"response-payload-1"}),"Response payload"),(0,i.kt)("p",null,"The response body contains the detailed information of one single broker:"),(0,i.kt)("pre",null,(0,i.kt)("code",u({parentName:"pre"},{className:"language-json"}),'{\n  "id": "mosquitto2",\n  "name": "Mosquitto 2 Test Instance",\n  "status": {\n    "timestamp": 1234567,\n    "connected": true\n  },\n  "metrics": {\n    "version": "mosquitto version 2.1.0",\n    "clients": {\n      "total": "3",\n      "active": "1",\n      "connected": "1"\n    },\n    "load": {\n      "publish": {\n        "sent": {\n          "1min": "89.24",\n          "5min": "37.59",\n          "15min": "26.32"\n        }\n      },\n      "sockets": {\n        "15min": "0.87",\n        "1min": "1.96",\n        "5min": "0.74"\n      },\n      "connections": {\n        "15min": "0.87",\n        "1min": "1.96",\n        "5min": "0.74"\n      },\n      "messages": {\n        "received": {\n          "1min": "13.69",\n          "5min": "5.34",\n          "15min": "3.45"\n        },\n        "sent": {\n          "1min": "106.56",\n          "5min": "45.82",\n          "15min": "33.12"\n        }\n      },\n      "bytes": {\n        "received": {\n          "1min": "406.86",\n          "5min": "154.90",\n          "15min": "124.23"\n        },\n        "sent": {\n          "1min": "3418.76",\n          "5min": "1371.17",\n          "15min": "885.65"\n        }\n      }\n    },\n    "messages": {\n      "stored": "37",\n      "received": "195425",\n      "sent": "1207818"\n    },\n    "store": {\n      "messages": {\n        "count": "37",\n        "bytes": "200"\n      }\n    },\n    "subscriptions": {\n      "count": "7"\n    },\n    "retained messages": {\n      "count": "37"\n    },\n    "publish": {\n      "messages": {\n        "sent": "1012830"\n      },\n      "bytes": {\n        "sent": "5919457"\n      }\n    },\n    "bytes": {\n      "received": "17444986",\n      "sent": "43697617"\n    },\n    "uptime": "5367950 seconds"\n  }\n}\n')),(0,i.kt)("h3",u({},{id:"clusters"}),"Clusters"),(0,i.kt)("p",null,"This endpoint will retrieve statuses of all the clusters."),(0,i.kt)("h4",u({},{id:"url-and-http-methods-2"}),"URL and HTTP methods"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"URL: ",(0,i.kt)("inlineCode",{parentName:"li"},"/api/monitoring/clusters")),(0,i.kt)("li",{parentName:"ul"},"Method: ",(0,i.kt)("inlineCode",{parentName:"li"},"GET"))),(0,i.kt)("h4",u({},{id:"response-payload-2"}),"Response payload"),(0,i.kt)("p",null,"The response contains a list of all available clusters plus an additional counter. Each cluster information contains the name, the description and a status of the cluster. The latter can be one of:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"active: the cluster is active and working"),(0,i.kt)("li",{parentName:"ul"},"degraded: the cluster is active, but not all nodes are healthy"),(0,i.kt)("li",{parentName:"ul"},"inactive: the cluster is inactive")),(0,i.kt)("pre",null,(0,i.kt)("code",u({parentName:"pre"},{className:"language-json"}),'{\n  "total": 3,\n  "clusters": [\n    {\n      "name": "mosquittotests1",\n      "description": "Mosquitto Test Cluster 1",\n      "status": {\n        "clusterstate": "active"\n      }\n    },\n    {\n      "name": "mosquittotests2",\n      "description": "Mosquitto Test Cluster 2",\n      "status": {\n        "clusterstate": "degraded"\n      }\n    },\n    {\n      "name": "mosquittotests3",\n      "description": "Mosquitto Test Cluster 3",\n      "status": {\n        "clusterstate": "inactive"\n      }\n    },\n  ]\n}\n')),(0,i.kt)("h3",u({},{id:"single-cluster"}),"Single Cluster"),(0,i.kt)("p",null,"This endpoint will retrieve the status of a single cluster."),(0,i.kt)("h4",u({},{id:"url-and-http-methods-3"}),"URL and HTTP methods"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"URL: ",(0,i.kt)("inlineCode",{parentName:"li"},"/api/monitoring/clusters")),(0,i.kt)("li",{parentName:"ul"},"Method: ",(0,i.kt)("inlineCode",{parentName:"li"},"GET"))),(0,i.kt)("h4",u({},{id:"response-payload-3"}),"Response payload"),(0,i.kt)("p",null,"The response body contains the detailed information of one single cluster. For every cluster the same information is included as in the \u201cClusters\u201d endpoint plus additional detail information, i.e., specific information about each node in the cluster."),(0,i.kt)("pre",null,(0,i.kt)("code",u({parentName:"pre"},{className:"language-json"}),'{\n  "name": "mosquittotests1",\n  "description": "Mosquitto Test Cluster 1",\n  "status": {\n    "clusterstate": "active"\n  },\n  "details": {\n    "nodes": [\n      {\n        "address": "172.20.1.1",\n        "port": 7000,\n        "nodeid": 1,\n        "broker": "mosquitto1",\n        "leader": true\n      },\n      {\n        "address": "172.20.1.2",\n        "port": 7000,\n        "nodeid": 2,\n        "broker": "mosquitto2",\n        "leader": false\n      },\n      {\n        "address": "172.20.1.3",\n        "port": 7000,\n        "nodeid": 2,\n        "broker": "mosquitto3",\n        "leader": false\n      }\n    ]\n  }\n}\n')),(0,i.kt)("h2",u({},{id:"authentication"}),"Authentication"),(0,i.kt)("p",null,"The Monitoring REST API will provide the same authentication mechanism that all other existing REST APIs of the Management Center use. This authentication mechanism is described in the REST API page. You can also use Application Tokens to authenticate described on the separate page as well."),(0,i.kt)("h2",u({},{id:"versioning"}),"Versioning"),(0,i.kt)("p",null,"In order to be REST compliant the Media Type Versioning will be implemented. This means that the version number will not be included in the URL, but will be provided by the client when accessing the API by the Accept header. "),(0,i.kt)("pre",null,(0,i.kt)("code",u({parentName:"pre"},{}),"application/json;version=1\napplication/json;version=2\napplication/json;version=3\n")),(0,i.kt)("p",null,"etc."),(0,i.kt)("p",null,"The first version number will be ",(0,i.kt)("inlineCode",{parentName:"p"},"1"),". Whenever in future there is a breaking change to the API a new major version will be released."))}T.isMDXComponent=!0},49044:(e,n,t)=>{t.d(n,{Z:()=>r});var i=t(67294),s=t(74889),o=t(62659),a=t(83166);function r({inline:e}){return i.createElement(s.Z,{sx:{margin:e?"0px 5px":"5px",height:e?"22px":void 0,color:"#ffffff",backgroundColor:o.Z[500]},size:"small",icon:i.createElement(a.Z,{style:{color:"white"},size:"small"}),label:"Premium"})}},78901:(e,n,t)=>{t.d(n,{Z:()=>a});var i=t(67294),s=t(74889),o=t(13328);function a({version:e}){return e?i.createElement(s.Z,{sx:{margin:"5px"},color:"info",size:"small",icon:i.createElement(o.Z,{size:"small"}),label:`${e}`}):i.createElement(i.Fragment,null)}}}]);