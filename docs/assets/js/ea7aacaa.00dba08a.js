"use strict";(self.webpackChunkstreamsheets=self.webpackChunkstreamsheets||[]).push([[68003],{83166:(e,t,n)=>{var i=n(64836);t.Z=void 0;var a=i(n(64938)),o=n(85893),r=(0,a.default)((0,o.jsx)("path",{d:"M12 2 4 5v6.09c0 5.05 3.41 9.76 8 10.91 4.59-1.15 8-5.86 8-10.91V5l-8-3zm-1.06 13.54L7.4 12l1.41-1.41 2.12 2.12 4.24-4.24 1.41 1.41-5.64 5.66z"}),"GppGood");t.Z=r},35272:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>T,contentTitle:()=>m,default:()=>b,frontMatter:()=>h,metadata:()=>f,toc:()=>k});var i=n(3905),a=n(49044),o=Object.defineProperty,r=Object.defineProperties,l=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,c=(e,t,n)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,d=(e,t)=>{for(var n in t||(t={}))u.call(t,n)&&c(e,n,t[n]);if(s)for(var n of s(t))p.call(t,n)&&c(e,n,t[n]);return e};const h={id:"mosquitto-http-auth",title:"HTTP Authentication",sidebar_label:"HTTP Authentication"},m=void 0,f={unversionedId:"security/clients/mosquitto-http-auth",id:"version-3.1/security/clients/mosquitto-http-auth",title:"HTTP Authentication",description:"The HTTP Authentication plugin can be used to authenticate MQTT clients by querying an HTTP endpoint on a remote web server.",source:"@site/mosquitto_versioned_docs/version-3.1/security/clients/HTTP-auth.md",sourceDirName:"security/clients",slug:"/security/clients/mosquitto-http-auth",permalink:"/mosquitto/security/clients/mosquitto-http-auth",draft:!1,tags:[],version:"3.1",frontMatter:{id:"mosquitto-http-auth",title:"HTTP Authentication",sidebar_label:"HTTP Authentication"},sidebar:"someSidebar",previous:{title:"LDAP Authentication",permalink:"/mosquitto/security/clients/mosquitto-ldap-auth"},next:{title:"API Tokens",permalink:"/mosquitto/security/platform-access/api-tokens"}},T={},k=[{value:"Plugin Activation",id:"plugin-activation",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Full configuration example",id:"full-configuration-example",level:3},{value:"The HTTP server",id:"the-http-server",level:3}],g={toc:k};function b(e){var t,n=e,{components:o}=n,c=((e,t)=>{var n={};for(var i in e)u.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&s)for(var i of s(e))t.indexOf(i)<0&&p.call(e,i)&&(n[i]=e[i]);return n})(n,["components"]);return(0,i.kt)("wrapper",(t=d(d({},g),c),r(t,l({components:o,mdxType:"MDXLayout"}))),(0,i.kt)(a.Z,{mdxType:"PremiumFeature"}),(0,i.kt)("h1",d({},{id:"pro-mosquitto-http-authentication"}),"Pro Mosquitto HTTP Authentication"),(0,i.kt)("p",null,"The HTTP Authentication plugin can be used to authenticate MQTT clients by querying an HTTP endpoint on a remote web server."),(0,i.kt)("p",null,"To use the plugin, a configuration file must be specified (see ",(0,i.kt)("a",d({parentName:"p"},{href:"#configuration-example"}),"example configuration")," for an example of such file and ",(0,i.kt)("a",d({parentName:"p"},{href:"#config-file-format"}),"config file format section")," for the overview of all possible configuration parameters)"),(0,i.kt)("h2",d({},{id:"plugin-activation"}),"Plugin Activation"),(0,i.kt)("p",null,"To enable the HTTP Auth plugin on the broker, add the following to the ",(0,i.kt)("inlineCode",{parentName:"p"},"mosquitto.conf")," file:"),(0,i.kt)("pre",null,(0,i.kt)("code",d({parentName:"pre"},{}),"plugin /usr/lib/cedalo_http_auth.so\n")),(0,i.kt)("p",null,"The plugin requires additional end user configuration to work, as described below."),(0,i.kt)("h2",d({},{id:"configuration"}),"Configuration"),(0,i.kt)("p",null,"The HTTP server address, request method, content type, and request parameters must be specified."),(0,i.kt)("p",null,"The server request address is the URL that the plugin must connect to in order\nto request authentication results."),(0,i.kt)("pre",null,(0,i.kt)("code",d({parentName:"pre"},{}),"plugin_opt_request_address https://127.0.0.1:8080/mqtt/auth\n")),(0,i.kt)("p",null,"The HTTP request method is one of ",(0,i.kt)("inlineCode",{parentName:"p"},"post"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"get"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"put"),", which correspond to\nthe HTTP method to use. It is recommended to use ",(0,i.kt)("inlineCode",{parentName:"p"},"post"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",d({parentName:"pre"},{}),"plugin_opt_request_method post\n")),(0,i.kt)("p",null,"The HTTP content type determines the format of the request data that will be\nsent to the HTTP server when making a POST request. It can be either\n",(0,i.kt)("inlineCode",{parentName:"p"},"application/x-www-form-urlencoded")," to use the traditional HTTP form encoding,\nor ",(0,i.kt)("inlineCode",{parentName:"p"},"application/json")," to use JSON encoding. Choose the option that makes\nsense for your authentication application."),(0,i.kt)("pre",null,(0,i.kt)("code",d({parentName:"pre"},{}),"plugin_opt_request_header_content_type application/x-www-form-urlencoded\n")),(0,i.kt)("p",null,"The request parameters determine what MQTT client parameters are sent to the\nserver for use in the authentication. This option should be a text string of\n",(0,i.kt)("inlineCode",{parentName:"p"},"key=parameter")," values separated by commas. You choose the ",(0,i.kt)("inlineCode",{parentName:"p"},"key")," names to match\nwhat you require and put the appropriate % parameter substitution from the list\nbelow."),(0,i.kt)("p",null,"The available parameters are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"%u : username"),(0,i.kt)("li",{parentName:"ul"},"%c : client id"),(0,i.kt)("li",{parentName:"ul"},"%a : client IP address"),(0,i.kt)("li",{parentName:"ul"},"%P : clear text password"),(0,i.kt)("li",{parentName:"ul"},"%p : client port"),(0,i.kt)("li",{parentName:"ul"},"%C : TLS client certificate common name"),(0,i.kt)("li",{parentName:"ul"},"%d : TLS client certificate subject")),(0,i.kt)("p",null,"Note that the TLS client certificate parameters are only available if the\nclient is using client certificates and if ",(0,i.kt)("inlineCode",{parentName:"p"},"require_certificates true")," is set\nin the mosquitto configuration."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"%r")," parameter for client access protocol is not available. Please get in\ntouch if this is important, and clarify what it should mean for you."),(0,i.kt)("pre",null,(0,i.kt)("code",d({parentName:"pre"},{}),"plugin_opt_request_params cid=%c,username=%u,ip-address=%a\n")),(0,i.kt)("h3",d({},{id:"full-configuration-example"}),"Full configuration example"),(0,i.kt)("pre",null,(0,i.kt)("code",d({parentName:"pre"},{}),"plugin /usr/lib/cedalo_http_auth.so\nplugin_opt_request_address https://127.0.0.1:8080/mqtt/auth\nplugin_opt_request_method post\nplugin_opt_request_header_content_type application/x-www-form-urlencoded\nplugin_opt_request_params clientid=%c,username=%u,password=%P,ip=%a,port=%p,cn=%C,subj=%d\n")),(0,i.kt)("h3",d({},{id:"the-http-server"}),"The HTTP server"),(0,i.kt)("p",null,"The HTTP server must respond to requests appropriately to allow/deny\nauthentication. If the server responds with an HTTP response status code of\n",(0,i.kt)("inlineCode",{parentName:"p"},"200"),", then the client will be authenticated. Any other respose status codes\nwill result in the client not being authenticated, but it is suggested that the\ncode ",(0,i.kt)("inlineCode",{parentName:"p"},"401")," should be used for this purpose. If the server sends a code of ",(0,i.kt)("inlineCode",{parentName:"p"},"200"),"\nand the body of the response is exactly ",(0,i.kt)("inlineCode",{parentName:"p"},"ignore"),", then the client will not be\nauthenticated."))}b.isMDXComponent=!0},49044:(e,t,n)=>{n.d(t,{Z:()=>l});var i=n(67294),a=n(39082),o=n(62659),r=n(83166);function l({inline:e}){return i.createElement(a.Z,{sx:{margin:e?"0px 5px":"0px 5px 5px 10px",height:e?"22px":void 0,color:"#ffffff",backgroundColor:o.Z[500]},size:"small",icon:i.createElement(r.Z,{style:{color:"white"},size:"small"}),label:"Premium"})}}}]);